<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>গার্মেন্টস স্যালারি ও ওটি ক্যালকুলেটর</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- Firebase SDK (Compat version for HTML) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-border: rgba(255, 255, 255, 0.2);
            --text-color: #ffffff;
            --text-muted: #d1d5db;
            --accent-color: #fbbf24;
            --bg-color: #1e1e2f;
            --nav-bg: rgba(30, 30, 47, 0.95);
            --success: #10b981;
            --danger: #ef4444;
            --radius: 16px;
        }

        /* Light Mode Improved */
        body.light-mode {
            --bg-color: #f0f2f5;
            --text-color: #1f2937;
            --text-muted: #4b5563;
            --card-bg: #ffffff;
            --card-border: #e5e7eb;
            --nav-bg: #ffffff;
            --primary-gradient: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
        }

        body.light-mode .glass-panel {
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e1e4e8;
            color: #333;
        }

        body.light-mode input,
        body.light-mode select {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            color: #111;
        }

        body.light-mode .btn-secondary {
            background: #e5e7eb;
            border: 1px solid #ccc;
            color: #333;
        }

        body.light-mode .nav-item.active {
            color: #e52e71;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Noto Sans Bengali', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            background-image: var(--primary-gradient);
            background-attachment: fixed;
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 90px;
            transition: background 0.3s ease;
        }

        .hidden {
            display: none !important;
        }

        .flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        .items-center {
            align-items: center;
        }

        .w-full {
            width: 100%;
        }

        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 0.5rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            transition: all 0.3s ease;
        }

        input,
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 10px;
            border: 1px solid var(--card-border);
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 1rem;
            outline: none;
        }

        button {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: none;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            color: white;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.1s;
        }

        button:active {
            transform: scale(0.96);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid white;
        }

        .btn-danger {
            background: var(--danger);
            color: white !important;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page {
            animation: fadeIn 0.4s ease-out;
            display: none;
            padding: 15px;
        }

        .page.active {
            display: block;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            border-top: 1px solid var(--card-border);
            z-index: 1000;
        }

        .nav-item {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 0.8rem;
            box-shadow: none;
        }

        .nav-item i {
            font-size: 1.3rem;
            display: block;
            margin-bottom: 4px;
        }

        .nav-item.active {
            color: var(--accent-color);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            border-radius: 12px;
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .bg-purple {
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
        }

        .bg-blue {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
        }

        .bg-orange {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
        }

        .bg-pink {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
        }

        .big-text {
            font-size: 1.4rem;
            font-weight: bold;
            margin-top: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .data-table th,
        .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .ad-container {
            margin: 15px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.05);
            border: 1px dashed rgba(255, 255, 255, 0.2);
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        body.light-mode .ad-container {
            background: #f0f2f5;
            border-color: #ddd;
        }

        #auth-screen,
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        #auth-screen {
            background: var(--primary-gradient);
            overflow-y: auto;
        }

        .modal {
            background: rgba(0, 0, 0, 0.85);
            z-index: 3000;
            display: none;
        }

        .modal.active {
            display: flex;
        }

        .app-logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            padding: 5px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>

<body>

    <!-- Auth Screen -->
    <div id="auth-screen">
        <img src="https://i.postimg.cc/kGZ8J76f/logo.png" class="app-logo" alt="Logo">
        <h2 style="color:white; margin-bottom: 20px; text-align:center;">গার্মেন্টস স্যালারি অ্যাপ</h2>
        <!-- Login Form -->
        <div id="login-form" class="glass-panel w-full" style="max-width: 350px;">
            <h3 class="mb-4 text-center">লগইন করুন</h3><input type="tel" id="login-phone" placeholder="মোবাইল নম্বর (11 digit)"><input type="password" id="login-pin" placeholder="পাসওয়ার্ড"><button onclick="handleLogin()">লগইন</button>
            <p class="mt-4 text-center text-sm" style="color:white">অ্যাকাউন্ট নেই? <a href="#" onclick="toggleAuth('signup')" style="color:var(--accent-color); font-weight:bold;">সাইন আপ করুন</a></p>
        </div>
        <!-- Signup Form -->
        <div id="signup-form" class="glass-panel w-full hidden" style="max-width: 350px;">
            <h3 class="mb-4 text-center">নতুন অ্যাকাউন্ট খুলুন</h3><input type="text" id="reg-name" placeholder="আপনার নাম"><input type="tel" id="reg-phone" placeholder="মোবাইল নম্বর"><select id="reg-designation" onchange="checkOtherDesignation()">
                <option value="">পদবী নির্বাচন করুন</option>
                <option value="Operator">Operator</option>
                <option value="Helper">Helper</option>
                <option value="Iron Man">Iron Man</option>
                <option value="Quality">Quality</option>
                <option value="PM">PM</option>
                <option value="GM">GM</option>
                <option value="Line Chief">Line Chief</option>
                <option value="Supervisor">Supervisor</option>
                <option value="Time keeper">Time keeper</option>
                <option value="Other">অন্যান্য</option>
            </select><input type="text" id="reg-other-designation" placeholder="পদবী লিখুন" class="hidden">
            <div class="flex" style="gap: 5px;"><input type="text" id="reg-grade" placeholder="গ্রেড"><input type="number" id="reg-basic" placeholder="বেসিক বেতন"></div><input type="number" id="reg-gross" placeholder="মোট বেতন (Gross)"><input type="password" id="reg-pin" placeholder="পাসওয়ার্ড দিন (কমপক্ষে ৬ সংখ্যা)"><button onclick="handleSignup()">সাইন আপ</button>
            <p class="mt-4 text-center text-sm" style="color:white">আগেই অ্যাকাউন্ট আছে? <a href="#" onclick="toggleAuth('login')" style="color:var(--accent-color); font-weight:bold;">লগইন</a></p>
        </div>
    </div>

    <!-- Bonus Setup Modal -->
    <div id="bonus-setup-modal" class="modal">
        <div class="glass-panel w-full" style="max-width: 350px; background: var(--bg-color);">
            <h3 class="text-center mb-4">হাজিরা বোনাস সেটআপ</h3>
            <p class="text-sm text-muted mb-4 text-center">আপনার ফ্যাক্টরিতে হাজিরা বোনাস কত টাকা?</p><input type="number" id="setup-bonus-amount" placeholder="যেমন: 725 বা 500"><button onclick="saveBonusSetting()">সেভ করুন</button>
        </div>
    </div>

    <!-- Main App Content -->
    <div id="app-content" class="hidden">
        <!-- HOME PAGE -->
        <div id="home" class="page active">
            <div class="flex justify-between items-center mb-4">
                <div>
                    <h2 id="home-greeting">স্বাগতম!</h2>
                    <p class="text-sm" id="current-date-display" style="opacity:0.8"></p>
                </div><img src="https://i.postimg.cc/kGZ8J76f/logo.png" style="width: 40px; border-radius:50%">
            </div>
            <div class="summary-grid">
                <div class="stat-card bg-purple">
                    <p>মোট ওভারটাইম</p>
                    <div class="big-text"><span id="total-ot-hours">0</span> ঘ</div>
                </div>
                <div class="stat-card bg-blue">
                    <p>আনুমানিক বেতন</p>
                    <div class="big-text"><span id="est-salary">0</span> ৳</div>
                </div>
                <div class="stat-card bg-orange">
                    <p>হাজিরা বোনাস</p>
                    <div class="big-text"><span id="display-bonus">0</span> ৳</div>
                </div>
                <div class="stat-card bg-pink">
                    <p>অন্যান্য সুবিধা</p>
                    <div class="big-text"><span id="other-bills">0</span> ৳</div>
                </div>
            </div>
            <div class="glass-panel mt-4">
                <div class="flex justify-between items-center mb-2">
                    <h3><i class="fas fa-calendar-alt" style="color: var(--accent-color)"></i> সরকারি ছুটি</h3><span class="text-sm" style="background:var(--accent-color); padding:2px 8px; border-radius:10px; color:#000;">বর্তমান মাস</span>
                </div>
                <div id="holiday-list" style="min-height: 50px;"></div>
            </div>
            <div class="ad-container" style="width: 300px; height: 250px;">Ad Space: 300x250<script type="text/javascript">
                    atOptions = {
                        'key': 'f05e53994372c08a40f69021b94c737b',
                        'format': 'iframe',
                        'height': 250,
                        'width': 300,
                        'params': {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/f05e53994372c08a40f69021b94c737b/invoke.js"></script>
            </div>
        </div>
        <!-- OVERTIME PAGE -->
        <div id="overtime" class="page">
            <h2 class="mb-4">ওভারটাইম যোগ করুন</h2>
            <div class="ad-container" style="width: 468px; height: 60px; max-width: 100%;">Ad Space: 468x60<script type="text/javascript">
                    atOptions = {
                        'key': 'cbfb25dda043c3217cef8dea9f896df2',
                        'format': 'iframe',
                        'height': 60,
                        'width': 468,
                        'params': {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/cbfb25dda043c3217cef8dea9f896df2/invoke.js"></script>
            </div>
            <div class="glass-panel mt-4"><label>তারিখ</label><input type="date" id="ot-date"><label>কাজের ধরণ</label><select id="ot-type" onchange="toggleOtHoursInput()">
                    <option value="General">General Day</option>
                    <option value="Night">Night</option>
                    <option value="Friday">Friday/Holiday</option>
                    <option value="Absent">Absent</option>
                </select>
                <div id="ot-hours-container"><label>ওভারটাইম (ঘন্টা)</label><input type="number" id="ot-hours" placeholder="যেমন: ২ অথবা ৪"></div><button onclick="addOvertime()" class="mt-2"><i class="fas fa-plus-circle"></i> সেভ করুন</button>
            </div>
            <div class="glass-panel mt-4">
                <h3><i class="fas fa-utensils"></i> টিফিন / নাইট বিল</h3><select id="bill-type">
                    <option value="Tiffin">টিফিন বিল</option>
                    <option value="NightBill">নাইট বিল</option>
                    <option value="Other">অন্যান্য</option>
                </select><input type="number" id="bill-amount" placeholder="টাকার পরিমাণ"><button onclick="addBill()" class="btn-secondary mt-2">বিল যোগ করুন</button>
            </div>
        </div>
        <!-- CALCULATOR PAGE -->
        <div id="calculator" class="page">
            <h2 class="mb-4">বেতন ক্যালকুলেটর</h2>
            <div class="glass-panel">
                <div class="flex justify-between mb-2"><span>মোট বেতন:</span><span id="calc-gross">0</span></div>
                <div class="flex justify-between mb-2"><span>বেসিক:</span><span id="calc-basic">0</span></div>
                <div class="flex justify-between mb-4"><span>মোট OT ঘন্টা:</span><span id="calc-total-ot">0</span></div>
                <hr style="border:0; border-top:1px solid rgba(255,255,255,0.3); margin: 10px 0;">
                <div class="flex items-center mb-4"><input type="checkbox" id="check-att-bonus" style="width: 20px; height: 20px; margin: 0 10px 0 0;" checked><label for="check-att-bonus">হাজিরা বোনাস (<span id="calc-bonus-amt">0</span> টাকা) যোগ হবে?</label></div><button onclick="calculateSalaryDetails()">হিসাব করুন</button>
            </div>
            <div id="calc-result" class="glass-panel hidden mt-4" style="background: rgba(16, 185, 129, 0.1);">
                <h3 class="text-center mb-2" style="color: var(--success)">হিসাবের বিবরণ</h3>
                <table class="w-full text-sm">
                    <tr>
                        <td>বেসিক সেলারি:</td>
                        <td class="text-right" id="res-basic">0</td>
                    </tr>
                    <tr>
                        <td>বাড়ি ভাড়া:</td>
                        <td class="text-right" id="res-house">0</td>
                    </tr>
                    <tr>
                        <td>চিকিৎসা ভাতা:</td>
                        <td class="text-right" id="res-med">0</td>
                    </tr>
                    <tr>
                        <td>OT রেট:</td>
                        <td class="text-right" id="res-ot-rate">0</td>
                    </tr>
                    <tr>
                        <td>মোট OT টাকা:</td>
                        <td class="text-right" id="res-ot-total">0</td>
                    </tr>
                    <tr>
                        <td>হাজিরা বোনাস:</td>
                        <td class="text-right" id="res-bonus">0</td>
                    </tr>
                    <tr>
                        <td>অন্যান্য বিল:</td>
                        <td class="text-right" id="res-bills">0</td>
                    </tr>
                    <tr style="font-weight: bold; border-top: 1px solid white;">
                        <td class="pt-2">সর্বমোট বেতন:</td>
                        <td class="pt-2 text-right" id="res-grand-total">0</td>
                    </tr>
                </table>
            </div>
            <div class="ad-container" style="width: 320px; height: 50px;">Ad Space: 320x50<script type="text/javascript">
                    atOptions = {
                        'key': 'c9a0024b83c53997d0f0f8b4f10653c9',
                        'format': 'iframe',
                        'height': 50,
                        'width': 320,
                        'params': {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/c9a0024b83c53997d0f0f8b4f10653c9/invoke.js"></script>
            </div>
        </div>
        <!-- LIST PAGE -->
        <div id="list" class="page">
            <h2 class="mb-4">কাজের তালিকা</h2>
            <div class="ad-container" style="width: 728px; height: 90px; max-width: 100%;">Ad Space: 728x90<script type="text/javascript">
                    atOptions = {
                        'key': '82181d21b05884891d9488e2b7fb793b',
                        'format': 'iframe',
                        'height': 90,
                        'width': 728,
                        'params': {}
                    };
                </script>
                <script type="text/javascript" src="//www.highperformanceformat.com/82181d21b05884891d9488e2b7fb793b/invoke.js"></script>
            </div>
            <div class="glass-panel" style="padding: 0;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>তারিখ</th>
                            <th>ধরণ</th>
                            <th>পরিমাণ</th>
                            <th>একশন</th>
                        </tr>
                    </thead>
                    <tbody id="work-history-body"></tbody>
                </table>
                <div id="empty-msg" class="p-4 text-center text-muted hidden">কোন তথ্য পাওয়া যায়নি</div>
            </div>
        </div>
        <!-- PROFILE PAGE -->
        <div id="profile" class="page">
            <div class="glass-panel text-center">
                <div class="app-logo" style="margin: 0 auto 10px; display:flex; justify-content:center; align-items:center; font-size: 2rem; color: #333; font-weight:bold;"><span id="avatar-initial">U</span></div>
                <h3 id="profile-name">User Name</h3>
                <p id="profile-desig" class="text-sm" style="color: var(--accent-color)">Designation</p>
                <p id="profile-phone" class="text-sm text-muted">01xxxxxxxxx</p>
                <div class="mt-2 text-sm">গ্রেড: <span id="profile-grade">N/A</span> | বেতন: <span id="profile-gross">0</span></div>
            </div>
            <div class="glass-panel mt-4">
                <button onclick="openModal('edit-profile-modal')" class="btn-secondary mb-2"><i class="fas fa-user-edit"></i> তথ্য পরিবর্তন</button>
                <button onclick="openModal('change-password-modal')" class="btn-secondary mb-2"><i class="fas fa-key"></i> পাসওয়ার্ড পরিবর্তন</button>
                <button onclick="toggleDarkMode()" class="btn-secondary mb-2"><i class="fas fa-moon"></i> লাইট/ডার্ক মোড</button>
                <button onclick="openModal('privacy-modal')" class="btn-secondary mb-2"><i class="fas fa-shield-alt"></i> গোপনীয়তা নীতি</button>
                <button onclick="logout()" class="btn-danger"><i class="fas fa-sign-out-alt"></i> লগআউট</button>
            </div>
            <p class="text-center text-sm text-muted mt-4">Version 2.2.0</p>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav hidden" id="main-nav">
        <button class="nav-item active" onclick="navTo('home')"><i class="fas fa-home"></i> হোম</button>
        <button class="nav-item" onclick="navTo('overtime')"><i class="fas fa-clock"></i> ওটি</button>
        <button class="nav-item" onclick="navTo('calculator')"><i class="fas fa-calculator"></i> হিসাব</button>
        <button class="nav-item" onclick="navTo('list')"><i class="fas fa-list"></i> তালিকা</button>
        <button class="nav-item" onclick="navTo('profile')"><i class="fas fa-user"></i> প্রোফাইল</button>
    </nav>

    <!-- MODALS -->
    <div id="edit-profile-modal" class="modal">
        <div class="glass-panel w-full" style="max-width: 400px; background: var(--bg-color);">
            <h3>তথ্য পরিবর্তন</h3>
            <p class="text-sm text-muted mb-4">একবার পরিবর্তন করলে ৭ দিন লক থাকবে।</p><input type="text" id="edit-name" placeholder="নাম"><input type="text" id="edit-desig" placeholder="পদবী"><input type="text" id="edit-grade" placeholder="গ্রেড"><input type="number" id="edit-gross" placeholder="নতুন মোট বেতন"><button onclick="saveProfileEdit()">সেভ করুন</button><button onclick="closeModal('edit-profile-modal')" class="btn-secondary mt-2">বাতিল</button>
        </div>
    </div>
    <div id="change-password-modal" class="modal">
        <div class="glass-panel w-full" style="max-width: 400px; background: var(--bg-color);">
            <h3>পাসওয়ার্ড পরিবর্তন করুন</h3><input type="password" id="current-pass" placeholder="বর্তমান পাসওয়ার্ড"><input type="password" id="new-pass" placeholder="নতুন পাসওয়ার্ড (কমপক্ষে ৬ সংখ্যা)"><input type="password" id="confirm-new-pass" placeholder="নতুন পাসওয়ার্ড নিশ্চিত করুন"><button onclick="handleChangePassword()">পরিবর্তন করুন</button><button onclick="closeModal('change-password-modal')" class="btn-secondary mt-2">বাতিল</button>
        </div>
    </div>
    <div id="privacy-modal" class="modal">
        <div class="glass-panel w-full" style="max-width: 500px; background: var(--bg-color);">
            <h3>গোপনীয়তা নীতি</h3>
            <div style="height:300px; overflow-y:auto; font-size:0.9rem; margin: 10px 0; text-align: left; padding: 0 10px;">
                <p><strong>ভূমিকা:</strong> আমরা আপনার তথ্যের গোপনীয়তাকে সম্মান করি। এই অ্যাপটি ব্যবহারের মাধ্যমে আপনি আমাদের নীতিমালায় সম্মতি জানাচ্ছেন।</p>
                <p class="mt-2"><strong>১. তথ্য সংগ্রহ:</strong></p>
                <ul>
                    <li><strong>ব্যক্তিগত তথ্য:</strong> সাইন আপ করার সময় আমরা আপনার নাম, ফোন নম্বর, পদবী, গ্রেড এবং বেতন সম্পর্কিত তথ্য সংগ্রহ করি।</li>
                    <li><strong>ব্যবহারের তথ্য:</strong> আপনি কখন ওভারটাইম বা বিল যোগ করছেন, সেই তথ্যগুলো আপনার অ্যাকাউন্টের অধীনে আমাদের সুরক্ষিত ডেটাবেজে সংরক্ষিত থাকে।</li>
                </ul>
                <p class="mt-2"><strong>২. তথ্যের ব্যবহার:</strong></p>
                <ul>
                    <li>আপনার মাসিক বেতন ও ওভারটাইম নির্ভুলভাবে হিসাব করার জন্য।</li>
                    <li>অ্যাপের কার্যকারিতা উন্নত করতে এবং আপনাকে சிறந்த পরিষেবা দিতে।</li>
                </ul>
                <p class="mt-2"><strong>৩. তথ্যের নিরাপত্তা:</strong></p>
                <ul>
                    <li>আপনার সকল তথ্য Firebase Authentication দ্বারা সুরক্ষিত এবং আপনার পাসওয়ার্ড এনক্রিপ্টেড থাকে।</li>
                    <li>ডেটাবেজ রুলস অনুযায়ী, আপনি শুধুমাত্র আপনার নিজের তথ্য দেখতে বা পরিবর্তন করতে পারবেন।</li>
                </ul>
                <p class="mt-2"><strong>৪. থার্ড-পার্টি সার্ভিস:</strong></p>
                <ul>
                    <li>এই অ্যাপে বিজ্ঞাপন দেখানোর জন্য Adsterra-এর মতো থার্ড-পার্টি বিজ্ঞাপন নেটওয়ার্ক ব্যবহার করা হয়। তারা আপনার কিছু সাধারণ তথ্য (যেমন ডিভাইস) বিজ্ঞাপনের উদ্দেশ্যে ব্যবহার করতে পারে।</li>
                </ul>
                <p class="mt-2"><strong>৫. নীতি পরিবর্তন:</strong></p>
                <p>আমরা যেকোনো সময় এই গোপনীয়তা নীতি পরিবর্তন করার অধিকার রাখি।</p>
            </div><button onclick="closeModal('privacy-modal')">বন্ধ করুন</button>
        </div>
    </div>

    <!-- Social Bar Script (Loads once at the end for reliability) -->
    <script type="text/javascript" src="//pl21010220.effectivegatecpm.com/36/f2/6e/36f26ed6744e876235db846fba07df11.js"></script>

    <script>
        // --- CONFIGURATION ---
        const firebaseConfig = {
  apiKey: "AIzaSyCOets_8BQkDex92Qrb21uhzrAVRXnPXms",
  authDomain: "overtime-calculator-8c926.firebaseapp.com",
  databaseURL: "https://overtime-calculator-8c926-default-rtdb.firebaseio.com",
  projectId: "overtime-calculator-8c926",
  storageBucket: "overtime-calculator-8c926.firebasestorage.app",
  messagingSenderId: "1044899871918",
  appId: "1:1044899871918:web:5493af45b9927bafaac13f"
};
        let db, auth;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.database();
            auth = firebase.auth();
            console.log("Firebase Connected");
        } catch (e) {
            console.error("Firebase Config Missing", e);
            alert("Firebase কনফিগারেশন সঠিক নয়। অ্যাপ কাজ করবে না।");
        }

        let currentUser = null,
            currentData = {
                ot: [],
                bills: []
            };
        const allHolidays = ["2025-01-26", "2025-02-21", "2025-03-17", "2025-03-26", "2025-04-14", "2025-05-01", "2025-05-12", "2025-06-07", "2025-07-17", "2025-08-15", "2025-09-05", "2025-10-02", "2025-12-16", "2025-12-25"];

        // --- AUTHENTICATION ---
        if (auth) {
            auth.onAuthStateChanged(user => {
                if (user) {
                    loadUserData(user.uid);
                } else {
                    document.getElementById('auth-screen').classList.remove('hidden');
                    document.getElementById('app-content').classList.add('hidden');
                    document.getElementById('main-nav').classList.add('hidden');
                }
            });
        }

        function toggleAuth(mode) {
            document.getElementById('login-form').classList.toggle('hidden', mode === 'signup');
            document.getElementById('signup-form').classList.toggle('hidden', mode === 'login');
        }

        function checkOtherDesignation() {
            document.getElementById('reg-other-designation').classList.toggle('hidden', document.getElementById('reg-designation').value !== 'Other');
        }

        function handleSignup() {
            const name = document.getElementById('reg-name').value,
                phone = document.getElementById('reg-phone').value,
                desigVal = document.getElementById('reg-designation').value,
                desig = desigVal === 'Other' ? document.getElementById('reg-other-designation').value : desigVal,
                basic = parseFloat(document.getElementById('reg-basic').value),
                gross = parseFloat(document.getElementById('reg-gross').value),
                grade = document.getElementById('reg-grade').value,
                pin = document.getElementById('reg-pin').value;
            if (!name || phone.length !== 11 || !desig || !basic || !gross || pin.length < 6) {
                alert("সব তথ্য সঠিকভাবে দিন। মোবাইল নম্বর ১১ সংখ্যার এবং পাসওয়ার্ড কমপক্ষে ৬ সংখ্যার হতে হবে।");
                return;
            }
            const email = phone + "@gmcalculator.com";
            auth.createUserWithEmailAndPassword(email, pin).then(cred => {
                const userData = {
                    uid: cred.user.uid,
                    phone,
                    name,
                    designation: desig,
                    grade,
                    basic,
                    gross,
                    attendanceBonus: 0,
                    joined: new Date().toISOString()
                };
                db.ref('users/' + cred.user.uid).set(userData).then(() => {
                    currentUser = userData;
                    document.getElementById('auth-screen').classList.add('hidden');
                    document.getElementById('bonus-setup-modal').classList.add('active');
                });
            }).catch(error => alert("ত্রুটি: " + error.message));
        }

        function handleLogin() {
            const phone = document.getElementById('login-phone').value,
                pin = document.getElementById('login-pin').value,
                email = phone + "@gmcalculator.com";
            if (phone.length !== 11 || pin.length < 6) {
                alert("সঠিক মোবাইল নম্বর ও পাসওয়ার্ড দিন।");
                return;
            }
            auth.signInWithEmailAndPassword(email, pin).catch(error => alert("লগইন ব্যর্থ। মোবাইল নম্বর বা পাসওয়ার্ড চেক করুন।"));
        }

        function logout() {
            auth.signOut().then(() => location.reload());
        }

        // --- PASSWORD CHANGE ---
        function handleChangePassword() {
            const currentPass = document.getElementById('current-pass').value;
            const newPass = document.getElementById('new-pass').value;
            const confirmPass = document.getElementById('confirm-new-pass').value;
            if (newPass.length < 6) {
                alert("নতুন পাসওয়ার্ড কমপক্ষে ৬ সংখ্যার হতে হবে।");
                return;
            }
            if (newPass !== confirmPass) {
                alert("নতুন পাসওয়ার্ড দুটি মিলছে না।");
                return;
            }
            const user = auth.currentUser;
            const cred = firebase.auth.EmailAuthProvider.credential(user.email, currentPass);
            user.reauthenticateWithCredential(cred).then(() => {
                return user.updatePassword(newPass);
            }).then(() => {
                alert("পাসওয়ার্ড সফলভাবে পরিবর্তন হয়েছে!");
                closeModal('change-password-modal');
            }).catch(error => {
                alert("ত্রুটি: বর্তমান পাসওয়ার্ড ভুল হতে পারে।");
            });
        }

        // --- BONUS SETUP ---
        function saveBonusSetting() {
            const bonus = parseFloat(document.getElementById('setup-bonus-amount').value);
            if (isNaN(bonus) || bonus < 0) {
                alert("সঠিক টাকার পরিমাণ দিন");
                return;
            }
            if (currentUser && db) {
                db.ref('users/' + currentUser.uid).update({
                    attendanceBonus: bonus
                });
                currentUser.attendanceBonus = bonus;
                closeModal('bonus-setup-modal');
                showApp();
            }
        }

        // --- MAIN APP LOGIC ---
        function loadUserData(uid) {
            db.ref('users/' + uid).once('value').then(snap => {
                currentUser = snap.val();
                if (!currentUser) return;
                if (!currentUser.attendanceBonus && currentUser.attendanceBonus !== 0) {
                    document.getElementById('auth-screen').classList.add('hidden');
                    document.getElementById('bonus-setup-modal').classList.add('active');
                } else {
                    showApp();
                }
            });
        }

        function showApp() {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('bonus-setup-modal').classList.remove('active');
            document.getElementById('app-content').classList.remove('hidden');
            document.getElementById('main-nav').classList.remove('hidden');
            document.getElementById('current-date-display').innerText = new Date().toLocaleDateString('bn-BD', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            fillProfileUI();
            loadHistoryData();
            renderCurrentMonthHolidays();
            navTo('home');
        }

        function fillProfileUI() {
            ['home-greeting', 'profile-name'].forEach(id => document.getElementById(id).innerText = id === 'home-greeting' ? `হাই, ${currentUser.name}` : currentUser.name);
            ['desig', 'phone', 'grade', 'gross'].forEach(id => document.getElementById(`profile-${id}`).innerText = currentUser[id]);
            document.getElementById('avatar-initial').innerText = currentUser.name.charAt(0).toUpperCase();
            ['calc-gross', 'calc-basic', 'calc-bonus-amt', 'display-bonus'].forEach(id => document.getElementById(id).innerText = {
                'calc-gross': currentUser.gross,
                'calc-basic': currentUser.basic,
                'calc-bonus-amt': currentUser.attendanceBonus,
                'display-bonus': currentUser.attendanceBonus
            } [id]);
            ['edit-name', 'edit-desig', 'edit-grade', 'edit-gross'].forEach(id => document.getElementById(id).value = currentUser[id.split('-')[1]]);
        }

        function loadHistoryData() {
            db.ref('data/' + currentUser.uid).on('value', snap => {
                const val = snap.val();
                currentData = val ? val : {
                    ot: [],
                    bills: []
                };
                if (!currentData.ot) currentData.ot = [];
                if (!currentData.bills) currentData.bills = [];
                updateUI();
            });
        }

        function updateUI() {
            const totalOT = (currentData.ot || []).reduce((sum, item) => sum + (item.hours || 0), 0);
            const totalBills = (currentData.bills || []).reduce((sum, item) => sum + (item.amount || 0), 0);
            document.getElementById('total-ot-hours').innerText = totalOT;
            document.getElementById('other-bills').innerText = totalBills;
            const otAmount = Math.round(totalOT * ((currentUser.basic / 208) * 2));
            document.getElementById('est-salary').innerText = Math.round(currentUser.gross + otAmount + currentUser.attendanceBonus + totalBills);
            document.getElementById('calc-total-ot').innerText = totalOT;
            const tbody = document.getElementById('work-history-body');
            const allEntries = [...(currentData.ot || []), ...(currentData.bills || [])].sort((a, b) => b.id - a.id);
            tbody.innerHTML = allEntries.map(item => `<tr><td>${item.date}</td><td>${{'General':'জেনারেল','Night':'নাইট','Friday':'ছুটি'}[item.type]||item.type}</td><td>${item.category==='OT'?item.hours+' ঘ':item.amount+' ৳'}</td><td><button onclick="deleteEntry(${item.id},'${item.category}')" class="btn-danger" style="padding:4px 8px;"><i class="fas fa-trash"></i></button></td></tr>`).join('');
            document.getElementById('empty-msg').classList.toggle('hidden', allEntries.length > 0);
        }

        function renderCurrentMonthHolidays() {
            const list = document.getElementById('holiday-list'),
                currentMonth = new Date().getMonth();
            const monthHolidays = allHolidays.filter(h => new Date(h).getMonth() === currentMonth);
            list.innerHTML = monthHolidays.length ? monthHolidays.map(h => `<div style="padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between;"><span>${new Date(h).toLocaleDateString('bn-BD',{day:'numeric',month:'long'})}</span><span style="color:var(--accent-color)">সরকারি ছুটি</span></div>`).join('') : '<p class="text-sm text-center p-2 text-muted">এই মাসে কোনো সরকারি ছুটি নেই।</p>';
        }

        // --- ACTIONS ---
        function addOvertime() {
            const date = document.getElementById('ot-date').value,
                type = document.getElementById('ot-type').value;
            let hours = parseFloat(document.getElementById('ot-hours').value);
            if (!date) {
                alert("তারিখ দিন");
                return;
            }
            if (type !== 'Absent' && (isNaN(hours) || hours < 0)) {
                alert("সঠিক ঘন্টা লিখুন");
                return;
            }
            hours = type === 'Absent' ? 0 : hours;
            currentData.ot.push({
                id: Date.now(),
                date,
                type,
                hours,
                category: 'OT'
            });
            syncData();
            alert("ওভারটাইম যুক্ত হয়েছে!");
        }

        function addBill() {
            const type = document.getElementById('bill-type').value,
                amount = parseFloat(document.getElementById('bill-amount').value);
            if (isNaN(amount) || amount <= 0) {
                alert("সঠিক টাকার পরিমাণ দিন");
                return;
            }
            currentData.bills.push({
                id: Date.now(),
                date: new Date().toISOString().split('T')[0],
                type,
                amount,
                category: 'Bill'
            });
            syncData();
            alert("বিল যুক্ত হয়েছে!");
        }

        function deleteEntry(id, category) {
            if (confirm("মুছে ফেলতে চান?")) {
                if (category === 'OT') currentData.ot = currentData.ot.filter(x => x.id !== id);
                else currentData.bills = currentData.bills.filter(x => x.id !== id);
                syncData();
            }
        }

        function syncData() {
            if (currentUser && db) {
                db.ref('data/' + currentUser.uid).set(currentData);
            }
        }

        function calculateSalaryDetails() {
            const basic = currentUser.basic,
                gross = currentUser.gross,
                totalOT = parseFloat(document.getElementById('calc-total-ot').innerText),
                otRate = (basic / 208) * 2,
                otAmount = Math.round(totalOT * otRate),
                bonus = document.getElementById('check-att-bonus').checked ? currentUser.attendanceBonus : 0,
                bills = parseFloat(document.getElementById('other-bills').innerText);
            ['res-basic', 'res-house', 'res-med', 'res-ot-rate', 'res-ot-total', 'res-bonus', 'res-bills', 'res-grand-total'].forEach(id => {
                const values = {
                    'res-basic': basic,
                    'res-house': Math.round(basic * 0.5),
                    'res-med': Math.round(basic * 0.1),
                    'res-ot-rate': otRate.toFixed(2),
                    'res-ot-total': otAmount,
                    'res-bonus': bonus,
                    'res-bills': bills,
                    'res-grand-total': Math.round(gross + otAmount + bonus + bills)
                };
                document.getElementById(id).innerText = values[id];
            });
            document.getElementById('calc-result').classList.remove('hidden');
            document.getElementById('calc-result').scrollIntoView({
                behavior: 'smooth'
            });
        }

        // --- PROFILE EDIT ---
        function saveProfileEdit() {
            const now = Date.now();
            if ((now - (currentUser.lastProfileEdit || 0)) / (1000 * 3600 * 24) < 7) {
                alert(`তথ্য ৭ দিনের আগে পরিবর্তন করা যাবে না।`);
                return;
            }
            const updates = {
                name: document.getElementById('edit-name').value,
                designation: document.getElementById('edit-desig').value,
                grade: document.getElementById('edit-grade').value,
                gross: parseFloat(document.getElementById('edit-gross').value),
                lastProfileEdit: now
            };
            db.ref('users/' + currentUser.uid).update(updates).then(() => {
                alert("তথ্য আপডেট হয়েছে!");
                currentUser = {
                    ...currentUser,
                    ...updates
                };
                fillProfileUI();
                closeModal('edit-profile-modal');
            });
        }

        // --- HELPERS ---
        function toggleOtHoursInput() {
            document.getElementById('ot-hours-container').style.display = (document.getElementById('ot-type').value === 'Absent') ? 'none' : 'block';
        }

        function navTo(pageId) {
            document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const index = ['home', 'overtime', 'calculator', 'list', 'profile'].indexOf(pageId);
            if (index >= 0) document.querySelectorAll('.nav-item')[index].classList.add('active');
        }

        function openModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        function toggleDarkMode() {
            document.body.classList.toggle('light-mode');
        }
    </script>
</body>

</html>            --text-muted: #4b5563;
            --card-bg: #ffffff;
            --card-border: #e5e7eb;
            --nav-bg: #ffffff;
            --primary-gradient: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
        }
        
        body.light-mode .glass-panel {
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e1e4e8;
            color: #333;
        }

        body.light-mode input, body.light-mode select {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            color: #111;
        }
        body.light-mode .btn-secondary { background: #e5e7eb; border: 1px solid #ccc; color: #333; }
        body.light-mode .nav-item.active { color: #e52e71; }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', 'Noto Sans Bengali', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color);
            background-image: var(--primary-gradient);
            background-attachment: fixed;
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 90px;
            transition: background 0.3s ease;
        }

        /* Utility & Reusable Classes */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }
        .w-full { width: 100%; }
        .text-center { text-align: center; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        
        /* Glassmorphism Cards */
        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            transition: all 0.3s ease;
        }

        /* Inputs & Buttons */
        input, select {
            width: 100%; padding: 12px; margin-bottom: 10px;
            border-radius: 10px; border: 1px solid var(--card-border);
            background: rgba(255, 255, 255, 0.9); color: #333;
            font-size: 1rem; outline: none;
        }
        
        button {
            width: 100%; padding: 12px; border-radius: 10px; border: none;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            color: white; font-weight: 600; font-size: 1rem; cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.96); }
        .btn-secondary { background: rgba(255,255,255,0.2); border: 1px solid white; }
        .btn-danger { background: var(--danger); color: white !important; }

        /* Page Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .page { animation: fadeIn 0.4s ease-out; display: none; padding: 15px; }
        .page.active { display: block; }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--nav-bg); backdrop-filter: blur(10px);
            display: flex; justify-content: space-around; padding: 12px 0;
            border-top: 1px solid var(--card-border); z-index: 1000;
        }
        .nav-item { background: none; border: none; color: var(--text-muted); font-size: 0.8rem; box-shadow: none; }
        .nav-item i { font-size: 1.3rem; display: block; margin-bottom: 4px; }
        .nav-item.active { color: var(--accent-color); }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-card { text-align: center; padding: 15px; border-radius: 12px; color: white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .bg-purple { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); }
        .bg-blue { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); }
        .bg-orange { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); }
        .bg-pink { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); }
        .big-text { font-size: 1.4rem; font-weight: bold; margin-top: 5px; }
        
        /* Table */
        .data-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .data-table th, .data-table td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 0.9rem; }
        
        /* Ad Containers */
        .ad-container { margin: 15px auto; text-align: center; overflow: hidden; display: flex; justify-content: center; align-items: center; border-radius: 8px; background: rgba(0,0,0,0.02); }

        /* Auth & Modal */
        #auth-screen, .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2000; display: flex; flex-direction: column; 
            justify-content: center; align-items: center; padding: 20px;
        }
        #auth-screen { background: var(--primary-gradient); overflow-y: auto; }
        .modal { background: rgba(0,0,0,0.85); z-index: 3000; display: none; }
        .modal.active { display: flex; }
        .app-logo { width: 80px; height: 80px; background: white; border-radius: 50%; padding: 5px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <!-- Auth Screen -->
    <div id="auth-screen">
        <img src="https://i.postimg.cc/kGZ8J76f/logo.png" class="app-logo" alt="Logo">
        <h2 style="color:white; margin-bottom: 20px; text-align:center;">গার্মেন্টস স্যালারি অ্যাপ</h2>
        
        <!-- Login Form -->
        <div id="login-form" class="glass-panel w-full" style="max-width: 350px;">
            <h3 class="mb-4 text-center">লগইন করুন</h3>
            <input type="tel" id="login-phone" placeholder="মোবাইল নম্বর (11 digit)">
            <input type="password" id="login-pin" placeholder="পাসওয়ার্ড" maxlength="6">
            <button onclick="handleLogin()">লগইন</button>
            <p class="mt-4 text-center text-sm" style="color:white">অ্যাকাউন্ট নেই? <a href="#" onclick="toggleAuth('signup')" style="color:var(--accent-color); font-weight:bold;">সাইন আপ করুন</a></p>
        </div>

        <!-- Signup Form -->
        <div id="signup-form" class="glass-panel w-full hidden" style="max-width: 350px;">
            <h3 class="mb-4 text-center">নতুন অ্যাকাউন্ট খুলুন</h3>
            <input type="text" id="reg-name" placeholder="আপনার নাম">
            <input type="tel" id="reg-phone" placeholder="মোবাইল নম্বর">
            <select id="reg-designation" onchange="checkOtherDesignation()">
                <option value="">পদবী নির্বাচন করুন</option>
                <option value="Operator">Operator</option><option value="Helper">Helper</option><option value="Iron Man">Iron Man</option><option value="Quality">Quality</option><option value="PM">PM</option><option value="GM">GM</option><option value="Line Chief">Line Chief</option><option value="Supervisor">Supervisor</option><option value="Time keeper">Time keeper</option><option value="Other">অন্যান্য (Other)</option>
            </select>
            <input type="text" id="reg-other-designation" placeholder="পদবী লিখুন" class="hidden">
            <div class="flex" style="gap: 5px;"><input type="text" id="reg-grade" placeholder="গ্রেড"><input type="number" id="reg-basic" placeholder="বেসিক বেতন"></div>
            <input type="number" id="reg-gross" placeholder="মোট বেতন (Gross)">
            <input type="password" id="reg-pin" placeholder="পাসওয়ার্ড দিন (কমপক্ষে ৬ সংখ্যা)" maxlength="6">
            <button onclick="handleSignup()">সাইন আপ</button>
            <p class="mt-4 text-center text-sm" style="color:white">আগেই অ্যাকাউন্ট আছে? <a href="#" onclick="toggleAuth('login')" style="color:var(--accent-color); font-weight:bold;">লগইন</a></p>
        </div>
    </div>

    <!-- Bonus Setup Modal -->
    <div id="bonus-setup-modal" class="modal">
        <div class="glass-panel w-full" style="max-width: 350px; background: var(--bg-color);">
            <h3 class="text-center mb-4">হাজিরা বোনাস সেটআপ</h3>
            <p class="text-sm text-muted mb-4 text-center">আপনার ফ্যাক্টরিতে হাজিরা বোনাস কত টাকা?</p>
            <input type="number" id="setup-bonus-amount" placeholder="যেমন: 725 বা 500">
            <button onclick="saveBonusSetting()">সেভ করুন</button>
        </div>
    </div>

    <!-- Main App Content -->
    <div id="app-content" class="hidden">
        <!-- HOME PAGE -->
        <div id="home" class="page active">
            <div class="flex justify-between items-center mb-4">
                <div><h2 id="home-greeting">স্বাগতম!</h2><p class="text-sm" id="current-date-display" style="opacity:0.8"></p></div>
                <img src="https://i.postimg.cc/kGZ8J76f/logo.png" style="width: 40px; border-radius:50%">
            </div>
            <div class="summary-grid">
                <div class="stat-card bg-purple"><p>মোট ওভারটাইম</p><div class="big-text"><span id="total-ot-hours">0</span> ঘ</div></div>
                <div class="stat-card bg-blue"><p>আনুমানিক বেতন</p><div class="big-text"><span id="est-salary">0</span> ৳</div></div>
                <div class="stat-card bg-orange"><p>হাজিরা বোনাস</p><div class="big-text"><span id="display-bonus">0</span> ৳</div></div>
                <div class="stat-card bg-pink"><p>অন্যান্য সুবিধা</p><div class="big-text"><span id="other-bills">0</span> ৳</div></div>
            </div>
            <div class="glass-panel mt-4">
                <div class="flex justify-between items-center mb-2"><h3><i class="fas fa-calendar-alt" style="color: var(--accent-color)"></i> সরকারি ছুটি</h3><span class="text-sm" style="background:var(--accent-color); padding:2px 8px; border-radius:10px; color:#000;">বর্তমান মাস</span></div>
                <div id="holiday-list" style="min-height: 50px;"></div>
            </div>
            <div class="ad-container" style="width: 300px; height: 250px;"><script type="text/javascript">atOptions={'key':'f05e53994372c08a40f69021b94c737b','format':'iframe','height':250,'width':300,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/f05e53994372c08a40f69021b94c737b/invoke.js"></script></div>
        </div>
        <!-- OVERTIME PAGE -->
        <div id="overtime" class="page">
            <h2 class="mb-4">ওভারটাইম যোগ করুন</h2>
            <div class="ad-container" style="width: 468px; height: 60px; max-width: 100%;"><script type="text/javascript">atOptions={'key':'cbfb25dda043c3217cef8dea9f896df2','format':'iframe','height':60,'width':468,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/cbfb25dda043c3217cef8dea9f896df2/invoke.js"></script></div>
            <div class="glass-panel mt-4"><label>তারিখ</label><input type="date" id="ot-date"><label>কাজের ধরণ</label><select id="ot-type" onchange="toggleOtHoursInput()"><option value="General">General Day</option><option value="Night">Night</option><option value="Friday">Friday/Holiday</option><option value="Absent">Absent</option></select><div id="ot-hours-container"><label>ওভারটাইম (ঘন্টা)</label><input type="number" id="ot-hours" placeholder="যেমন: ২ অথবা ৪"></div><button onclick="addOvertime()" class="mt-2"><i class="fas fa-plus-circle"></i> সেভ করুন</button></div>
            <div class="glass-panel mt-4"><h3><i class="fas fa-utensils"></i> টিফিন / নাইট বিল</h3><select id="bill-type"><option value="Tiffin">টিফিন বিল</option><option value="NightBill">নাইট বিল</option><option value="Other">অন্যান্য</option></select><input type="number" id="bill-amount" placeholder="টাকার পরিমাণ"><button onclick="addBill()" class="btn-secondary mt-2">বিল যোগ করুন</button></div>
        </div>
        <!-- CALCULATOR PAGE -->
        <div id="calculator" class="page">
            <h2 class="mb-4">বেতন ক্যালকুলেটর</h2>
            <div class="glass-panel"><div class="flex justify-between mb-2"><span>মোট বেতন:</span><span id="calc-gross">0</span></div><div class="flex justify-between mb-2"><span>বেসিক:</span><span id="calc-basic">0</span></div><div class="flex justify-between mb-4"><span>মোট OT ঘন্টা:</span><span id="calc-total-ot">0</span></div><hr style="border:0; border-top:1px solid rgba(255,255,255,0.3); margin: 10px 0;"><div class="flex items-center mb-4"><input type="checkbox" id="check-att-bonus" style="width: 20px; height: 20px; margin: 0 10px 0 0;" checked><label for="check-att-bonus">হাজিরা বোনাস (<span id="calc-bonus-amt">0</span> টাকা) যোগ হবে?</label></div><button onclick="calculateSalaryDetails()">হিসাব করুন</button></div>
            <div id="calc-result" class="glass-panel hidden mt-4" style="background: rgba(16, 185, 129, 0.1);"><h3 class="text-center mb-2" style="color: var(--success)">হিসাবের বিবরণ</h3><table class="w-full text-sm"><tr><td>বেসিক সেলারি:</td><td class="text-right" id="res-basic">0</td></tr><tr><td>বাড়ি ভাড়া:</td><td class="text-right" id="res-house">0</td></tr><tr><td>চিকিৎসা ভাতা:</td><td class="text-right" id="res-med">0</td></tr><tr><td>OT রেট:</td><td class="text-right" id="res-ot-rate">0</td></tr><tr><td>মোট OT টাকা:</td><td class="text-right" id="res-ot-total">0</td></tr><tr><td>হাজিরা বোনাস:</td><td class="text-right" id="res-bonus">0</td></tr><tr><td>অন্যান্য বিল:</td><td class="text-right" id="res-bills">0</td></tr><tr style="font-weight: bold; border-top: 1px solid white;"><td class="pt-2">সর্বমোট বেতন:</td><td class="pt-2 text-right" id="res-grand-total">0</td></tr></table></div>
            <div class="ad-container" style="width: 320px; height: 50px;"><script type="text/javascript">atOptions={'key':'c9a0024b83c53997d0f0f8b4f10653c9','format':'iframe','height':50,'width':320,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/c9a0024b83c53997d0f0f8b4f10653c9/invoke.js"></script></div>
        </div>
        <!-- LIST PAGE -->
        <div id="list" class="page">
            <h2 class="mb-4">কাজের তালিকা</h2>
            <div class="ad-container" style="width: 728px; height: 90px; max-width: 100%;"><script type="text/javascript">atOptions={'key':'82181d21b05884891d9488e2b7fb793b','format':'iframe','height':90,'width':728,'params':{}};</script><script type="text/javascript" src="//www.highperformanceformat.com/82181d21b05884891d9488e2b7fb793b/invoke.js"></script></div>
            <div class="glass-panel" style="padding: 0;"><table class="data-table"><thead><tr><th>তারিখ</th><th>ধরণ</th><th>পরিমাণ</th><th>একশন</th></tr></thead><tbody id="work-history-body"></tbody></table><div id="empty-msg" class="p-4 text-center text-muted hidden">কোন তথ্য পাওয়া যায়নি</div></div>
        </div>
        <!-- PROFILE PAGE -->
        <div id="profile" class="page">
            <div class="glass-panel text-center"><div class="app-logo" style="margin: 0 auto 10px; display:flex; justify-content:center; align-items:center; font-size: 2rem; color: #333; font-weight:bold;"><span id="avatar-initial">U</span></div><h3 id="profile-name">User Name</h3><p id="profile-desig" class="text-sm" style="color: var(--accent-color)">Designation</p><p id="profile-phone" class="text-sm text-muted">01xxxxxxxxx</p><div class="mt-2 text-sm">গ্রেড: <span id="profile-grade">N/A</span> | বেতন: <span id="profile-gross">0</span></div></div>
            <div class="glass-panel mt-4">
                <button onclick="openModal('edit-profile-modal')" class="btn-secondary mb-2"><i class="fas fa-user-edit"></i> তথ্য পরিবর্তন</button>
                <button onclick="openModal('change-password-modal')" class="btn-secondary mb-2"><i class="fas fa-key"></i> পাসওয়ার্ড পরিবর্তন</button>
                <button onclick="toggleDarkMode()" class="btn-secondary mb-2"><i class="fas fa-moon"></i> লাইট/ডার্ক মোড</button>
                <button onclick="openModal('privacy-modal')" class="btn-secondary mb-2"><i class="fas fa-shield-alt"></i> গোপনীয়তা নীতি</button>
                <button onclick="logout()" class="btn-danger"><i class="fas fa-sign-out-alt"></i> লগআউট</button>
            </div>
            <p class="text-center text-sm text-muted mt-4">Version 2.1.0</p>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav hidden" id="main-nav">
        <button class="nav-item active" onclick="navTo('home')"><i class="fas fa-home"></i> হোম</button>
        <button class="nav-item" onclick="navTo('overtime')"><i class="fas fa-clock"></i> ওটি</button>
        <button class="nav-item" onclick="navTo('calculator')"><i class="fas fa-calculator"></i> হিসাব</button>
        <button class="nav-item" onclick="navTo('list')"><i class="fas fa-list"></i> তালিকা</button>
        <button class="nav-item" onclick="navTo('profile')"><i class="fas fa-user"></i> প্রোফাইল</button>
    </nav>

    <!-- MODALS -->
    <!-- EDIT PROFILE MODAL -->
    <div id="edit-profile-modal" class="modal"><div class="glass-panel w-full" style="max-width: 400px; background: var(--bg-color);"><h3>তথ্য পরিবর্তন</h3><p class="text-sm text-muted mb-4">একবার পরিবর্তন করলে ৭ দিন লক থাকবে।</p><input type="text" id="edit-name" placeholder="নাম"><input type="text" id="edit-desig" placeholder="পদবী"><input type="text" id="edit-grade" placeholder="গ্রেড"><input type="number" id="edit-gross" placeholder="নতুন মোট বেতন"><button onclick="saveProfileEdit()">সেভ করুন</button><button onclick="closeModal('edit-profile-modal')" class="btn-secondary mt-2">বাতিল</button></div></div>
    
    <!-- CHANGE PASSWORD MODAL -->
    <div id="change-password-modal" class="modal"><div class="glass-panel w-full" style="max-width: 400px; background: var(--bg-color);"><h3>পাসওয়ার্ড পরিবর্তন করুন</h3><input type="password" id="current-pass" placeholder="বর্তমান পাসওয়ার্ড"><input type="password" id="new-pass" placeholder="নতুন পাসওয়ার্ড (কমপক্ষে ৬ সংখ্যা)"><input type="password" id="confirm-new-pass" placeholder="নতুন পাসওয়ার্ড নিশ্চিত করুন"><button onclick="handleChangePassword()">পরিবর্তন করুন</button><button onclick="closeModal('change-password-modal')" class="btn-secondary mt-2">বাতিল</button></div></div>

    <!-- PRIVACY MODAL (UPDATED) -->
    <div id="privacy-modal" class="modal"><div class="glass-panel w-full" style="max-width: 500px; background: var(--bg-color);"><h3>গোপনীয়তা নীতি</h3><div style="height:300px; overflow-y:auto; font-size:0.9rem; margin: 10px 0; text-align: left; padding: 0 10px;"><p><strong>ভূমিকা:</strong> আমরা আপনার তথ্যের গোপনীয়তাকে সম্মান করি। এই অ্যাপটি ব্যবহারের মাধ্যমে আপনি আমাদের নীতিমালায় সম্মতি জানাচ্ছেন।</p><p class="mt-2"><strong>১. তথ্য সংগ্রহ:</strong></p><ul><li><strong>ব্যক্তিগত তথ্য:</strong> সাইন আপ করার সময় আমরা আপনার নাম, ফোন নম্বর, পদবী, গ্রেড এবং বেতন সম্পর্কিত তথ্য সংগ্রহ করি।</li><li><strong>ব্যবহারের তথ্য:</strong> আপনি কখন ওভারটাইম বা বিল যোগ করছেন, সেই তথ্যগুলো আপনার অ্যাকাউন্টের অধীনে আমাদের সুরক্ষিত ডেটাবেজে সংরক্ষিত থাকে।</li></ul><p class="mt-2"><strong>২. তথ্যের ব্যবহার:</strong></p><ul><li>আপনার মাসিক বেতন ও ওভারটাইম নির্ভুলভাবে হিসাব করার জন্য।</li><li>অ্যাপের কার্যকারিতা উন্নত করতে এবং আপনাকে சிறந்த পরিষেবা দিতে।</li></ul><p class="mt-2"><strong>৩. তথ্যের নিরাপত্তা:</strong></p><ul><li>আপনার সকল তথ্য Firebase Authentication দ্বারা সুরক্ষিত এবং আপনার পাসওয়ার্ড এনক্রিপ্টেড থাকে।</li><li>ডেটাবেজ রুলস অনুযায়ী, আপনি শুধুমাত্র আপনার নিজের তথ্য দেখতে বা পরিবর্তন করতে পারবেন।</li></ul><p class="mt-2"><strong>৪. থার্ড-পার্টি সার্ভিস:</strong></p><ul><li>এই অ্যাপে বিজ্ঞাপন দেখানোর জন্য Adsterra-এর মতো থার্ড-পার্টি বিজ্ঞাপন নেটওয়ার্ক ব্যবহার করা হয়। তারা আপনার কিছু সাধারণ তথ্য (যেমন ডিভাইস) বিজ্ঞাপনের উদ্দেশ্যে ব্যবহার করতে পারে।</li></ul><p class="mt-2"><strong>৫. নীতি পরিবর্তন:</strong></p><p>আমরা যেকোনো সময় এই গোপনীয়তা নীতি পরিবর্তন করার অধিকার রাখি।</p></div><button onclick="closeModal('privacy-modal')">বন্ধ করুন</button></div></div>

    <!-- Social Bar Script (Loads once at the end for reliability) -->
    <script type="text/javascript" src="//pl21010220.effectivegatecpm.com/36/f2/6e/36f26ed6744e876235db846fba07df11.js"></script>

    <script>
        // --- CONFIGURATION ---
        const firebaseConfig = {
  apiKey: "AIzaSyCOets_8BQkDex92Qrb21uhzrAVRXnPXms",
  authDomain: "overtime-calculator-8c926.firebaseapp.com",
  databaseURL: "https://overtime-calculator-8c926-default-rtdb.firebaseio.com",
  projectId: "overtime-calculator-8c926",
  storageBucket: "overtime-calculator-8c926.firebasestorage.app",
  messagingSenderId: "1044899871918",
  appId: "1:1044899871918:web:5493af45b9927bafaac13f"
};
        let db, auth;
        try { firebase.initializeApp(firebaseConfig); db = firebase.database(); auth = firebase.auth(); console.log("Firebase Connected"); } catch (e) { console.error("Firebase Config Missing", e); }

        let currentUser = null, currentData = { ot: [], bills: [] };
        const allHolidays = ["2025-01-26", "2025-02-21", "2025-03-17", "2025-03-26", "2025-04-14", "2025-05-01", "2025-05-12", "2025-06-07", "2025-07-17", "2025-08-15", "2025-09-05", "2025-10-02", "2025-12-16", "2025-12-25"];

        // --- AUTHENTICATION ---
        if(auth) { auth.onAuthStateChanged(user => { if (user) { loadUserData(user.uid); } else { document.getElementById('auth-screen').classList.remove('hidden'); document.getElementById('app-content').classList.add('hidden'); document.getElementById('main-nav').classList.add('hidden'); } }); }
        function toggleAuth(mode) { document.getElementById('login-form').classList.toggle('hidden', mode === 'signup'); document.getElementById('signup-form').classList.toggle('hidden', mode === 'login'); }
        function checkOtherDesignation() { document.getElementById('reg-other-designation').classList.toggle('hidden', document.getElementById('reg-designation').value !== 'Other'); }

        function handleSignup() {
            const name = document.getElementById('reg-name').value, phone = document.getElementById('reg-phone').value, desigVal = document.getElementById('reg-designation').value, desig = desigVal === 'Other' ? document.getElementById('reg-other-designation').value : desigVal, basic = parseFloat(document.getElementById('reg-basic').value), gross = parseFloat(document.getElementById('reg-gross').value), grade = document.getElementById('reg-grade').value, pin = document.getElementById('reg-pin').value;
            if (!name || phone.length !== 11 || !desig || !basic || !gross || pin.length < 6) { alert("সব তথ্য সঠিকভাবে দিন। মোবাইল নম্বর ১১ সংখ্যার এবং পাসওয়ার্ড কমপক্ষে ৬ সংখ্যার হতে হবে।"); return; }
            const email = phone + "@gmcalculator.com";
            auth.createUserWithEmailAndPassword(email, pin).then(cred => {
                const userData = { uid: cred.user.uid, phone, name, designation: desig, grade, basic, gross, attendanceBonus: 0, joined: new Date().toISOString() };
                db.ref('users/' + cred.user.uid).set(userData).then(() => { currentUser = userData; document.getElementById('auth-screen').classList.add('hidden'); document.getElementById('bonus-setup-modal').classList.add('active'); });
            }).catch(error => alert("ত্রুটি: " + error.message));
        }

        function handleLogin() {
            const phone = document.getElementById('login-phone').value, pin = document.getElementById('login-pin').value, email = phone + "@gmcalculator.com";
            if(phone.length !== 11 || pin.length < 6) { alert("সঠিক মোবাইল নম্বর ও পাসওয়ার্ড দিন।"); return; }
            auth.signInWithEmailAndPassword(email, pin).catch(error => alert("লগইন ব্যর্থ। মোবাইল নম্বর বা পাসওয়ার্ড চেক করুন।"));
        }
        function logout() { auth.signOut().then(() => location.reload()); }

        // --- PASSWORD CHANGE ---
        function handleChangePassword() {
            const currentPass = document.getElementById('current-pass').value;
            const newPass = document.getElementById('new-pass').value;
            const confirmPass = document.getElementById('confirm-new-pass').value;
            if (newPass.length < 6) { alert("নতুন পাসওয়ার্ড কমপক্ষে ৬ সংখ্যার হতে হবে।"); return; }
            if (newPass !== confirmPass) { alert("নতুন পাসওয়ার্ড দুটি মিলছে না।"); return; }
            const user = auth.currentUser;
            const cred = firebase.auth.EmailAuthProvider.credential(user.email, currentPass);
            user.reauthenticateWithCredential(cred).then(() => {
                return user.updatePassword(newPass);
            }).then(() => {
                alert("পাসওয়ার্ড সফলভাবে পরিবর্তন হয়েছে!");
                closeModal('change-password-modal');
            }).catch(error => {
                alert("ত্রুটি: " + error.message);
            });
        }

        // --- BONUS SETUP ---
        function saveBonusSetting() {
            const bonus = parseFloat(document.getElementById('setup-bonus-amount').value);
            if(isNaN(bonus) || bonus < 0) { alert("সঠিক টাকার পরিমাণ দিন"); return; }
            if(currentUser && db) { db.ref('users/' + currentUser.uid).update({ attendanceBonus: bonus }); currentUser.attendanceBonus = bonus; closeModal('bonus-setup-modal'); showApp(); }
        }

        // --- MAIN APP LOGIC ---
        function loadUserData(uid) { db.ref('users/' + uid).once('value').then(snap => { currentUser = snap.val(); if(!currentUser) return; if(!currentUser.attendanceBonus) { document.getElementById('auth-screen').classList.add('hidden'); document.getElementById('bonus-setup-modal').classList.add('active'); } else { showApp(); } }); }
        function showApp() { document.getElementById('auth-screen').classList.add('hidden'); document.getElementById('bonus-setup-modal').classList.remove('active'); document.getElementById('app-content').classList.remove('hidden'); document.getElementById('main-nav').classList.remove('hidden'); document.getElementById('current-date-display').innerText = new Date().toLocaleDateString('bn-BD', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }); fillProfileUI(); loadHistoryData(); renderCurrentMonthHolidays(); navTo('home'); }
        function fillProfileUI() { ['home-greeting', 'profile-name'].forEach(id => document.getElementById(id).innerText = id === 'home-greeting' ? `হাই, ${currentUser.name}` : currentUser.name); ['desig', 'phone', 'grade', 'gross'].forEach(id => document.getElementById(`profile-${id}`).innerText = currentUser[id]); document.getElementById('avatar-initial').innerText = currentUser.name.charAt(0).toUpperCase(); ['calc-gross', 'calc-basic', 'calc-bonus-amt', 'display-bonus'].forEach(id => document.getElementById(id).innerText = { 'calc-gross': currentUser.gross, 'calc-basic': currentUser.basic, 'calc-bonus-amt': currentUser.attendanceBonus, 'display-bonus': currentUser.attendanceBonus }[id]); ['edit-name', 'edit-desig', 'edit-grade', 'edit-gross'].forEach(id => document.getElementById(id).value = currentUser[id.split('-')[1]]); }
        function loadHistoryData() { db.ref('data/' + currentUser.uid).on('value', snap => { const val = snap.val(); currentData = val ? val : { ot: [], bills: [] }; if(!currentData.ot) currentData.ot = []; if(!currentData.bills) currentData.bills = []; updateUI(); }); }
        
        function updateUI() {
            const totalOT = (currentData.ot || []).reduce((sum, item) => sum + (item.hours || 0), 0);
            const totalBills = (currentData.bills || []).reduce((sum, item) => sum + (item.amount || 0), 0);
            document.getElementById('total-ot-hours').innerText = totalOT;
            document.getElementById('other-bills').innerText = totalBills;
            const otAmount = Math.round(totalOT * ((currentUser.basic / 208) * 2));
            document.getElementById('est-salary').innerText = Math.round(currentUser.gross + otAmount + currentUser.attendanceBonus + totalBills);
            document.getElementById('calc-total-ot').innerText = totalOT;
            const tbody = document.getElementById('work-history-body');
            const allEntries = [...(currentData.ot||[]), ...(currentData.bills||[])].sort((a,b) => b.id - a.id);
            tbody.innerHTML = allEntries.map(item => `<tr><td>${item.date}</td><td>${{'General':'জেনারেল','Night':'নাইট','Friday':'ছুটি'}[item.type]||item.type}</td><td>${item.category==='OT'?item.hours+' ঘ':item.amount+' ৳'}</td><td><button onclick="deleteEntry(${item.id},'${item.category}')" class="btn-danger" style="padding:4px 8px;"><i class="fas fa-trash"></i></button></td></tr>`).join('');
            document.getElementById('empty-msg').classList.toggle('hidden', allEntries.length > 0);
        }

        function renderCurrentMonthHolidays() {
            const list = document.getElementById('holiday-list'), currentMonth = new Date().getMonth();
            const monthHolidays = allHolidays.filter(h => new Date(h).getMonth() === currentMonth);
            list.innerHTML = monthHolidays.length ? monthHolidays.map(h => `<div style="padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between;"><span>${new Date(h).toLocaleDateString('bn-BD',{day:'numeric',month:'long'})}</span><span style="color:var(--accent-color)">সরকারি ছুটি</span></div>`).join('') : '<p class="text-sm text-center p-2 text-muted">এই মাসে কোনো সরকারি ছুটি নেই।</p>';
        }

        // --- ACTIONS ---
        function addOvertime() { const date = document.getElementById('ot-date').value, type = document.getElementById('ot-type').value; let hours = parseFloat(document.getElementById('ot-hours').value); if (!date) { alert("তারিখ দিন"); return; } if (type !== 'Absent' && (isNaN(hours) || hours < 0)) { alert("সঠিক ঘন্টা লিখুন"); return; } hours = type === 'Absent' ? 0 : hours; currentData.ot.push({ id: Date.now(), date, type, hours, category: 'OT' }); syncData(); alert("ওভারটাইম যুক্ত হয়েছে!"); }
        function addBill() { const type = document.getElementById('bill-type').value, amount = parseFloat(document.getElementById('bill-amount').value); if (isNaN(amount) || amount <= 0) { alert("সঠিক টাকার পরিমাণ দিন"); return; } currentData.bills.push({ id: Date.now(), date: new Date().toISOString().split('T')[0], type, amount, category: 'Bill' }); syncData(); alert("বিল যুক্ত হয়েছে!"); }
        function deleteEntry(id, category) { if(confirm("মুছে ফেলতে চান?")) { if(category === 'OT') currentData.ot = currentData.ot.filter(x => x.id !== id); else currentData.bills = currentData.bills.filter(x => x.id !== id); syncData(); } }
        function syncData() { if(currentUser && db) { db.ref('data/' + currentUser.uid).set(currentData); } }
        function calculateSalaryDetails() { const basic = currentUser.basic, gross = currentUser.gross, totalOT = parseFloat(document.getElementById('calc-total-ot').innerText), otRate = (basic / 208) * 2, otAmount = Math.round(totalOT * otRate), bonus = document.getElementById('check-att-bonus').checked ? currentUser.attendanceBonus : 0, bills = parseFloat(document.getElementById('other-bills').innerText); ['res-basic','res-house','res-med','res-ot-rate','res-ot-total','res-bonus','res-bills','res-grand-total'].forEach(id => { const values = {'res-basic':basic,'res-house':Math.round(basic*0.5),'res-med':Math.round(basic*0.1),'res-ot-rate':otRate.toFixed(2),'res-ot-total':otAmount,'res-bonus':bonus,'res-bills':bills,'res-grand-total':Math.round(gross+otAmount+bonus+bills)}; document.getElementById(id).innerText = values[id]; }); document.getElementById('calc-result').classList.remove('hidden'); document.getElementById('calc-result').scrollIntoView({behavior:'smooth'}); }

        // --- PROFILE EDIT ---
        function saveProfileEdit() { const now = Date.now(); if ((now - (currentUser.lastProfileEdit || 0)) / (1000 * 3600 * 24) < 7) { alert(`তথ্য পরিবর্তন করা যাবে না।`); return; } const updates = { name: document.getElementById('edit-name').value, designation: document.getElementById('edit-desig').value, grade: document.getElementById('edit-grade').value, gross: parseFloat(document.getElementById('edit-gross').value), lastProfileEdit: now }; db.ref('users/' + currentUser.uid).update(updates).then(() => { alert("তথ্য আপডেট হয়েছে!"); currentUser = {...currentUser, ...updates}; fillProfileUI(); closeModal('edit-profile-modal'); }); }
        
        // --- HELPERS ---
        function toggleOtHoursInput() { document.getElementById('ot-hours-container').style.display = (document.getElementById('ot-type').value === 'Absent') ? 'none' : 'block'; }
        function navTo(pageId) { document.querySelectorAll('.page').forEach(el => el.classList.remove('active')); document.getElementById(pageId).classList.add('active'); document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active')); const index = ['home','overtime','calculator','list','profile'].indexOf(pageId); if(index >= 0) document.querySelectorAll('.nav-item')[index].classList.add('active'); }
        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }
        function toggleDarkMode() { document.body.classList.toggle('light-mode'); }
    </script>
</body>
</html>        
        .page-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .page-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        .btn-pulse:active {
            animation: pulse 0.3s ease;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        input, select, button {
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus {
            transform: scale(1.02);
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .step-form {
            display: none;
        }
        
        .step-form.active {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        .nav-item.active svg {
            color: #fbbf24;
        }
        
        .nav-item.active span {
            color: #fbbf24;
        }
        
        .theme-option {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }
        
        .theme-option:hover {
            transform: scale(1.1);
        }
        
        .theme-option.active {
            border-color: white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .plan-card {
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .plan-card:hover {
            transform: translateY(-10px);
            border-color: rgba(255, 255, 255, 0.8);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .plan-card.active {
            border-color: white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .subscription-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 999;
        }
    </style>
</head>
<body class="min-h-screen">
    
    <!-- Auth Page -->
    <div id="authPage" class="page active">
        <div class="min-h-screen flex items-center justify-center p-4">
            <div class="glass rounded-3xl p-8 w-full max-w-md relative">
                <!-- Language Toggle Button for Auth Page -->
                <button onclick="toggleAuthLanguage()" class="absolute top-4 right-4 bg-white bg-opacity-20 text-white px-3 py-2 rounded-lg flex items-center gap-2 btn-pulse">
                    <span>🌐</span>
                    <span id="authLangText">EN</span>
                </button>

                <div class="text-center mb-8">
                    <img src="https://i.postimg.cc/kGZ8J76f/logo.png" alt="Garments OT" class="w-20 h-20 rounded-full mx-auto mb-4">
                    <h1 class="text-3xl font-bold text-white mb-2" data-en="Garments OT" data-bn="গার্মেন্টস OT">Garments OT</h1>
                    <p class="text-white text-opacity-80" data-en="Overtime Calculator" data-bn="ওভারটাইম ক্যালকুলেটর">Overtime Calculator</p>
                </div>
                
                <!-- Login Form -->
                <div id="loginForm">
                    <h2 class="text-2xl font-bold text-white mb-6 text-center" data-en="Login" data-bn="লগইন করুন">Login</h2>
                    <div class="space-y-4">
                        <input type="tel" id="loginPhone" placeholder="Phone Number" data-en-placeholder="Phone Number" data-bn-placeholder="ফোন নম্বর" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        <input type="password" id="loginPin" placeholder="PIN Number" data-en-placeholder="PIN Number" data-bn-placeholder="পিন নম্বর" maxlength="4" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        <button onclick="login()" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold btn-pulse" data-en="Login" data-bn="লগইন">Login</button>
                        <button onclick="showSignup()" class="w-full py-3 bg-white bg-opacity-20 text-white rounded-xl font-bold btn-pulse" data-en="Create New Account" data-bn="নতুন একাউন্ট তৈরি করুন">Create New Account</button>
                    </div>
                </div>
                
                <!-- Signup Form -->
                <div id="signupForm" style="display: none;">
                    <h2 class="text-2xl font-bold text-white mb-6 text-center" data-en="Sign Up" data-bn="সাইন আপ করুন">Sign Up</h2>
                    
                    <div id="step1" class="step-form active">
                        <label class="text-white mb-2 block" data-en="Phone Number" data-bn="ফোন নম্বর">Phone Number</label>
                        <input type="tel" id="signupPhone" placeholder="01XXXXXXXXX" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none mb-4">
                        <button onclick="nextStep(2)" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Next" data-bn="পরবর্তী">Next</button>
                    </div>
                    
                    <div id="step2" class="step-form">
                        <label class="text-white mb-2 block" data-en="Name" data-bn="নাম">Name</label>
                        <input type="text" id="signupName" placeholder="Your Name" data-en-placeholder="Your Name" data-bn-placeholder="আপনার নাম লিখুন" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none mb-4">
                        <button onclick="nextStep(3)" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Next" data-bn="পরবর্তী">Next</button>
                    </div>
                    
                    <div id="step3" class="step-form">
                        <label class="text-white mb-2 block" data-en="Position" data-bn="পদবি">Position</label>
                        <select id="signupPosition" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none mb-4">
                            <option value="">Select Position</option>
                            <option value="Operator">Operator</option>
                            <option value="Helper">Helper</option>
                            <option value="Iron Man">Iron Man</option>
                            <option value="Quality">Quality</option>
                            <option value="PM">PM</option>
                            <option value="GM">GM</option>
                            <option value="AGM">AGM</option>
                            <option value="Line Chief">Line Chief</option>
                            <option value="Supervisor">Supervisor</option>
                        </select>
                        <button onclick="nextStep(4)" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Next" data-bn="পরবর্তী">Next</button>
                    </div>
                    
                    <div id="step4" class="step-form">
                        <label class="text-white mb-2 block" data-en="Grade" data-bn="গ্রেড">Grade</label>
                        <select id="signupGrade" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none mb-4">
                            <option value="">Select Grade</option>
                            <option value="Grade 1">Grade 1</option>
                            <option value="Grade 2">Grade 2</option>
                            <option value="Grade 3">Grade 3</option>
                            <option value="Grade 4">Grade 4</option>
                        </select>
                        <button onclick="nextStep(5)" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Next" data-bn="পরবর্তী">Next</button>
                    </div>
                    
                    <div id="step5" class="step-form">
                        <label class="text-white mb-2 block" data-en="Monthly Salary (TK)" data-bn="মাসিক বেতন (টাকা)">Monthly Salary (TK)</label>
                        <input type="number" id="signupSalary" placeholder="12500" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none mb-4">
                        <button onclick="nextStep(6)" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Next" data-bn="পরবর্তী">Next</button>
                    </div>
                    
                    <div id="step6" class="step-form">
                        <label class="text-white mb-2 block" data-en="PIN Number (4 Digits)" data-bn="পিন নম্বর (৪ ডিজিট)">PIN Number (4 Digits)</label>
                        <input type="password" id="signupPin" placeholder="****" maxlength="4" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none mb-4">
                        <button onclick="signup()" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold btn-pulse" data-en="Complete Signup" data-bn="সাইন আপ সম্পন্ন করুন">Complete Signup</button>
                    </div>
                    
                    <button onclick="showLogin()" class="w-full py-2 mt-4 text-white text-opacity-80 btn-pulse" data-en="Back to Login" data-bn="লগইনে ফিরে যান">Back to Login</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main App -->
    <div id="mainApp" class="page">
        
        <!-- Subscription Status -->
        <div class="subscription-status" id="subscriptionStatus" style="display: none;">
            <span id="statusText">Free Plan</span>
        </div>

        <!-- Home Page -->
        <div id="homePage" class="page-content active pb-24">
            <div class="p-6">
                <!-- Header -->
                <div class="glass rounded-3xl p-6 mb-6 slide-in">
                    <h2 class="text-white text-opacity-80 mb-2" data-en="Welcome" data-bn="স্বাগতম">Welcome</h2>
                    <h1 class="text-3xl font-bold text-white mb-4" id="userName">User</h1>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-4 card-hover">
                            <p class="text-white text-opacity-90 text-sm" data-en="Total Overtime" data-bn="মোট ওভারটাইম">Total Overtime</p>
                            <p class="text-3xl font-bold text-white" id="totalOT">0</p>
                        </div>
                        <div class="bg-gradient-to-br from-green-400 to-blue-500 rounded-2xl p-4 card-hover">
                            <p class="text-white text-opacity-90 text-sm" data-en="Estimated Salary" data-bn="আনুমানিক বেতন">Estimated Salary</p>
                            <p class="text-2xl font-bold text-white" id="estimatedSalary">৳0</p>
                        </div>
                        <div class="bg-gradient-to-br from-pink-400 to-red-500 rounded-2xl p-4 card-hover">
                            <p class="text-white text-opacity-90 text-sm" data-en="Attendance Bonus" data-bn="হাজিরা বোনাস">Attendance Bonus</p>
                            <p class="text-3xl font-bold text-white">৳<span id="attendanceBonusHome">725</span></p>
                        </div>
                        <div class="bg-gradient-to-br from-indigo-400 to-purple-500 rounded-2xl p-4 card-hover">
                            <p class="text-white text-opacity-90 text-sm" data-en="Other Benefits" data-bn="অন্যান্য সুবিধা">Other Benefits</p>
                            <p class="text-2xl font-bold text-white" id="otherBenefits">৳0</p>
                        </div>
                    </div>
                </div>
                
                <!-- Public Holidays -->
                <div class="glass rounded-3xl p-6 slide-in">
                    <h3 class="text-xl font-bold text-white mb-4" data-en="📅 Public Holidays This Month" data-bn="📅 চলতি মাসের সরকারি ছুটি">📅 Public Holidays This Month</h3>
                    <div id="holidaysList" class="space-y-3">
                        <!-- Holidays will be populated here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Overtime Page -->
        <div id="overtimePage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6 mb-6">
                    <h2 class="text-2xl font-bold text-white mb-6" data-en="Add Overtime" data-bn="ওভারটাইম যোগ করুন">Add Overtime</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="text-white mb-2 block" data-en="Select Date" data-bn="তারিখ নির্বাচন করুন">Select Date</label>
                            <input type="date" id="otDate" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>
                        
                        <div>
                            <label class="text-white mb-2 block" data-en="Select Type" data-bn="ধরন নির্বাচন করুন">Select Type</label>
                            <select id="otType" onchange="handleOTTypeChange()" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                                <option value="" data-en="Select" data-bn="নির্বাচন করুন">Select</option>
                                <option value="day" data-en="Day" data-bn="দিন">Day</option>
                                <option value="night" data-en="Night" data-bn="রাত">Night</option>
                                <option value="friday" data-en="Friday" data-bn="শুক্রবার">Friday</option>
                                <option value="absent" data-en="Absent" data-bn="অনুপস্থিত">Absent</option>
                            </select>
                        </div>
                        
                        <div id="fridayOptions" style="display: none;">
                            <label class="text-white mb-2 block" data-en="Friday Status" data-bn="শুক্রবার স্ট্যাটাস">Friday Status</label>
                            <select id="fridayType" onchange="handleFridayChange()" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                                <option value="">Select</option>
                                <option value="open">Open</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>
                        
                        <div id="otHoursDiv">
                            <label class="text-white mb-2 block" data-en="Overtime Hours" data-bn="ওভারটাইম ঘণ্টা">Overtime Hours</label>
                            <input type="number" id="otHours" step="0.5" placeholder="2" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        </div>
                        
                        <button onclick="addOT()" class="w-full py-4 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold text-lg btn-pulse" data-en="Add" data-bn="যোগ করুন">Add</button>
                    </div>
                </div>

                <!-- Tiffin & Night Bill -->
                <div class="glass rounded-3xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-6" data-en="Add Tiffin & Night Bill" data-bn="টিফিন ও নাইট বিল যোগ করুন">Add Tiffin & Night Bill</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="text-white mb-2 block" data-en="Select Date" data-bn="তারিখ নির্বাচন করুন">Select Date</label>
                            <input type="date" id="billDate" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Select Bill Type" data-bn="বিল ধরন নির্বাচন করুন">Select Bill Type</label>
                            <select id="billType" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                                <option value="">Select</option>
                                <option value="tiffin" data-en="Tiffin Bill" data-bn="টিফিন বিল">Tiffin Bill</option>
                                <option value="night" data-en="Night Bill" data-bn="নাইট বিল">Night Bill</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Amount (TK)" data-bn="পরিমাণ (টাকা)">Amount (TK)</label>
                            <input type="number" id="billAmount" placeholder="100" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        </div>

                        <button onclick="addBill()" class="w-full py-4 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold text-lg btn-pulse" data-en="Add Bill" data-bn="বিল যোগ করুন">Add Bill</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Calculator Page -->
        <div id="calculatorPage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6 mb-6">
                    <h2 class="text-2xl font-bold text-white mb-6" data-en="Salary Calculation" data-bn="বেতন হিসাব">Salary Calculation</h2>
                    
                    <div class="bg-gradient-to-br from-purple-400 to-pink-400 rounded-2xl p-6 mb-6">
                        <p class="text-white text-opacity-90 text-sm" data-en="Total Salary" data-bn="মোট বেতন">Total Salary</p>
                        <p class="text-4xl font-bold text-white" id="calcTotalSalary">৳0</p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 mb-6">
                        <p class="text-white text-opacity-90 text-sm" data-en="Total Overtime" data-bn="মোট ওভারটাইম">Total Overtime</p>
                        <p class="text-3xl font-bold text-white" id="calcTotalOT">0 hours</p>
                    </div>
                    
                    <button onclick="calculateSalary()" class="w-full py-4 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold text-lg btn-pulse mb-6" data-en="Calculate" data-bn="হিসাব করুন">Calculate</button>
                    
                    <div id="salaryBreakdown" style="display: none;" class="space-y-3">
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="Basic Salary" data-bn="মূল বেতন">Basic Salary</span>
                            <span class="text-white font-bold" id="basicSalary">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="House Rent" data-bn="বাড়ি ভাড়া">House Rent</span>
                            <span class="text-white font-bold" id="houseRent">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="Medical Allowance" data-bn="চিকিৎসা ভাতা">Medical Allowance</span>
                            <span class="text-white font-bold" id="medical">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="OT Rate (per hour)" data-bn="OT রেট (প্রতি ঘণ্টা)">OT Rate (per hour)</span>
                            <span class="text-white font-bold" id="otRate">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="OT Amount" data-bn="OT পরিমাণ">OT Amount</span>
                            <span class="text-white font-bold" id="otAmount">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="Attendance Bonus" data-bn="হাজিরা বোনাস">Attendance Bonus</span>
                            <span class="text-white font-bold" id="attendanceBonusCalc">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="Tiffin Bill" data-bn="টিফিন বিল">Tiffin Bill</span>
                            <span class="text-white font-bold" id="tiffinBillCalc">৳0</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-xl p-4 flex justify-between">
                            <span class="text-white" data-en="Night Bill" data-bn="নাইট বিল">Night Bill</span>
                            <span class="text-white font-bold" id="nightBillCalc">৳0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- List Page -->
        <div id="listPage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-white" data-en="Overtime List" data-bn="ওভারটাইম তালিকা">Overtime List</h2>
                    </div>
                    
                    <div class="mb-6">
                        <label class="text-white mb-2 block" data-en="Select Month" data-bn="মাস নির্বাচন করুন">Select Month</label>
                        <input type="month" id="listMonth" onchange="loadOTList()" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                    </div>
                    
                    <div id="monthlySummary" class="grid grid-cols-2 gap-3 mb-6">
                        <div class="bg-gradient-to-br from-purple-400 to-pink-400 rounded-xl p-3">
                            <p class="text-white text-opacity-90 text-xs" data-en="Total OT Hours" data-bn="মোট OT ঘণ্টা">Total OT Hours</p>
                            <p class="text-2xl font-bold text-white" id="summaryTotalOT">0</p>
                        </div>
                        <div class="bg-gradient-to-br from-yellow-400 to-orange-500 rounded-xl p-3">
                            <p class="text-white text-opacity-90 text-xs" data-en="Day Shifts" data-bn="দিনের শিফট">Day Shifts</p>
                            <p class="text-2xl font-bold text-white" id="summaryDay">0</p>
                        </div>
                        <div class="bg-gradient-to-br from-blue-400 to-indigo-500 rounded-xl p-3">
                            <p class="text-white text-opacity-90 text-xs" data-en="Night Shifts" data-bn="রাতের শিফট">Night Shifts</p>
                            <p class="text-2xl font-bold text-white" id="summaryNight">0</p>
                        </div>
                        <div class="bg-gradient-to-br from-green-400 to-teal-500 rounded-xl p-3">
                            <p class="text-white text-opacity-90 text-xs" data-en="Fridays" data-bn="শুক্রবার">Fridays</p>
                            <p class="text-2xl font-bold text-white" id="summaryFriday">0</p>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead>
                                <tr class="border-b border-white border-opacity-20">
                                    <th class="py-3 text-left" data-en="Date" data-bn="তারিখ">Date</th>
                                    <th class="py-3 text-left" data-en="Type" data-bn="ধরন">Type</th>
                                    <th class="py-3 text-left" data-en="Hours" data-bn="ঘণ্টা">Hours</th>
                                    <th class="py-3 text-left" data-en="Action" data-bn="অ্যাকশন">Action</th>
                                </tr>
                            </thead>
                            <tbody id="otListTable">
                                <!-- OT list will be populated here -->
                            </tbody>
                        </table>
                    </div>

                    <hr class="border-white border-opacity-20 my-6">

                    <h3 class="text-xl font-bold text-white mb-4" data-en="Bills" data-bn="বিল">Bills</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead>
                                <tr class="border-b border-white border-opacity-20">
                                    <th class="py-3 text-left" data-en="Date" data-bn="তারিখ">Date</th>
                                    <th class="py-3 text-left" data-en="Type" data-bn="ধরন">Type</th>
                                    <th class="py-3 text-left" data-en="Amount" data-bn="পরিমাণ">Amount</th>
                                    <th class="py-3 text-left" data-en="Action" data-bn="অ্যাকশন">Action</th>
                                </tr>
                            </thead>
                            <tbody id="billListTable">
                                <!-- Bill list will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profile Page -->
        <div id="profilePage" class="page-content pb-24">
            <div class="p-6">
                <!-- Profile Card -->
                <div class="glass rounded-3xl p-6 mb-6 text-center slide-in">
                    <div class="w-24 h-24 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full mx-auto mb-4 flex items-center justify-center">
                        <span class="text-4xl text-white" id="profileInitial">U</span>
                    </div>
                    <h2 class="text-2xl font-bold text-white mb-2" id="profileName">User</h2>
                    <p class="text-white text-opacity-80" id="profilePhone">+880XXXXXXXXXX</p>
                    <p class="text-white text-opacity-80" id="profilePosition">Position</p>
                    <p class="text-white text-opacity-80" id="profileGrade">Grade</p>
                </div>
                
                <!-- Theme Selection -->
                <div class="glass rounded-3xl p-6 mb-4">
                    <h3 class="text-xl font-bold text-white mb-4" data-en="Choose Theme" data-bn="থিম পছন্দ করুন">Choose Theme</h3>
                    <div class="grid grid-cols-5 gap-3">
                        <div class="theme-option active" onclick="changeTheme('default')" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" data-theme="default"></div>
                        <div class="theme-option" onclick="changeTheme('ocean')" style="background: linear-gradient(135deg, #2E3192 0%, #1BFFFF 100%);" data-theme="ocean"></div>
                        <div class="theme-option" onclick="changeTheme('sunset')" style="background: linear-gradient(135deg, #FF512F 0%, #F09819 100%);" data-theme="sunset"></div>
                        <div class="theme-option" onclick="changeTheme('forest')" style="background: linear-gradient(135deg, #134E5E 0%, #71B280 100%);" data-theme="forest"></div>
                        <div class="theme-option" onclick="changeTheme('rose')" style="background: linear-gradient(135deg, #F857A6 0%, #FF5858 100%);" data-theme="rose"></div>
                        <div class="theme-option" onclick="changeTheme('night')" style="background: linear-gradient(135deg, #000428 0%, #004e92 100%);" data-theme="night"></div>
                        <div class="theme-option" onclick="changeTheme('candy')" style="background: linear-gradient(135deg, #D3CCE3 0%, #E9E4F0 100%);" data-theme="candy"></div>
                        <div class="theme-option" onclick="changeTheme('mint')" style="background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);" data-theme="mint"></div>
                        <div class="theme-option" onclick="changeTheme('fire')" style="background: linear-gradient(135deg, #f12711 0%, #f5af19 100%);" data-theme="fire"></div>
                        <div class="theme-option" onclick="changeTheme('purple')" style="background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%);" data-theme="purple"></div>
                    </div>
                </div>
                
                <!-- Settings -->
                <div class="space-y-3">
                    <div onclick="showEditProfile()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer">
                        <span class="text-2xl mr-3">✏️</span>
                        <span class="text-white font-medium" data-en="Edit Profile" data-bn="প্রোফাইল সম্পাদনা">Edit Profile</span>
                    </div>

                    <div onclick="showSubscription()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer">
                        <span class="text-2xl mr-3">⭐</span>
                        <span class="text-white font-medium" data-en="Subscription Plan" data-bn="সাবস্ক্রিপশন প্ল্যান">Subscription Plan</span>
                    </div>

                    <div onclick="toggleDarkMode()" class="glass rounded-2xl p-4 flex items-center justify-between card-hover cursor-pointer">
                        <div class="flex items-center">
                            <span class="text-2xl mr-3">🌙</span>
                            <span class="text-white font-medium" data-en="Dark Mode" data-bn="ডার্ক মোড">Dark Mode</span>
                        </div>
                        <div id="darkModeToggle" class="w-12 h-6 bg-white bg-opacity-30 rounded-full relative">
                            <div class="w-5 h-5 bg-white rounded-full absolute top-0.5 left-0.5 transition-all"></div>
                        </div>
                    </div>
                    
                    <div onclick="toggleLanguage()" class="glass rounded-2xl p-4 flex items-center justify-between card-hover cursor-pointer">
                        <div class="flex items-center">
                            <span class="text-2xl mr-3">🌐</span>
                            <span class="text-white font-medium" data-en="Language" data-bn="ভাষা পরিবর্তন">Language</span>
                        </div>
                        <span class="text-white text-opacity-80" id="currentLang">English</span>
                    </div>
                    
                    <div onclick="showHelp()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer">
                        <span class="text-2xl mr-3">❓</span>
                        <span class="text-white font-medium" data-en="Help" data-bn="সাহায্য">Help</span>
                    </div>
                    
                    <div onclick="showPrivacy()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer">
                        <span class="text-2xl mr-3">🔒</span>
                        <span class="text-white font-medium" data-en="Privacy Policy" data-bn="গোপনীয়তা নীতি">Privacy Policy</span>
                    </div>
                    
                    <div onclick="showAbout()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer">
                        <span class="text-2xl mr-3">ℹ️</span>
                        <span class="text-white font-medium" data-en="About Us" data-bn="আমাদের সম্পর্কে">About Us</span>
                    </div>

                    <div onclick="openUpdateLink()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer bg-blue-500 bg-opacity-30">
                        <span class="text-2xl mr-3">📲</span>
                        <span class="text-white font-medium" data-en="Update App" data-bn="অ্যাপ আপডেট করুন">Update App</span>
                    </div>

                    <div class="glass rounded-2xl p-4 text-center">
                        <p class="text-white text-opacity-80 text-sm" data-en="App Version" data-bn="অ্যাপ সংস্করণ">App Version</p>
                        <p class="text-white font-bold">v1.0.0</p>
                    </div>
                    
                    <div onclick="logout()" class="glass rounded-2xl p-4 flex items-center card-hover cursor-pointer bg-red-500 bg-opacity-30">
                        <span class="text-2xl mr-3">🚪</span>
                        <span class="text-white font-medium" data-en="Logout" data-bn="লগ আউট">Logout</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Profile Page -->
        <div id="editProfilePage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-6" data-en="Edit Profile" data-bn="প্রোফাইল সম্পাদনা">Edit Profile</h2>
                    
                    <div id="editLocked" style="display: none;" class="bg-red-500 bg-opacity-30 rounded-xl p-4 mb-6 text-white">
                        <p data-en="You can edit your profile after 15 days" data-bn="१५ দিন পরে আপনার প্রোফাইল সম্পাদনা করতে পারবেন">You can edit your profile after 15 days</p>
                        <p class="text-sm mt-2" id="editUnlockDate"></p>
                    </div>

                    <div id="editForm" class="space-y-4">
                        <div>
                            <label class="text-white mb-2 block" data-en="Name" data-bn="নাম">Name</label>
                            <input type="text" id="editName" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Position" data-bn="পদবি">Position</label>
                            <select id="editPosition" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                                <option value="Operator">Operator</option>
                                <option value="Helper">Helper</option>
                                <option value="Iron Man">Iron Man</option>
                                <option value="Quality">Quality</option>
                                <option value="PM">PM</option>
                                <option value="GM">GM</option>
                                <option value="AGM">AGM</option>
                                <option value="Line Chief">Line Chief</option>
                                <option value="Supervisor">Supervisor</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Grade" data-bn="গ্রেড">Grade</label>
                            <select id="editGrade" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                                <option value="Grade 1">Grade 1</option>
                                <option value="Grade 2">Grade 2</option>
                                <option value="Grade 3">Grade 3</option>
                                <option value="Grade 4">Grade 4</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Monthly Salary (TK)" data-bn="মাসিক বেতন (টাকা)">Monthly Salary (TK)</label>
                            <input type="number" id="editSalary" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <button onclick="saveProfile()" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold btn-pulse" data-en="Save Changes" data-bn="পরিবর্তন সংরক্ষণ করুন">Save Changes</button>
                    </div>

                    <hr class="border-white border-opacity-20 my-6">

                    <h3 class="text-xl font-bold text-white mb-4" data-en="Change PIN" data-bn="পিন পরিবর্তন করুন">Change PIN</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="text-white mb-2 block" data-en="Current PIN" data-bn="বর্তমান পিন">Current PIN</label>
                            <input type="password" id="currentPin" maxlength="4" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="New PIN" data-bn="নতুন পিন">New PIN</label>
                            <input type="password" id="newPin" maxlength="4" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Confirm PIN" data-bn="পিন নিশ্চিত করুন">Confirm PIN</label>
                            <input type="password" id="confirmPin" maxlength="4" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white outline-none">
                        </div>

                        <button onclick="changePIN()" class="w-full py-3 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse" data-en="Change PIN" data-bn="পিন পরিবর্তন করুন">Change PIN</button>
                    </div>

                    <button onclick="showPage('profile')" class="w-full py-3 mt-6 bg-white bg-opacity-20 text-white rounded-xl font-bold btn-pulse" data-en="Back to Profile" data-bn="প্রোফাইলে ফিরে যান">Back to Profile</button>
                </div>
            </div>
        </div>

        <!-- Subscription Page -->
        <div id="subscriptionPage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-6 text-center" data-en="Subscription Plans" data-bn="সাবস্ক্রিপশন প্ল্যান">Subscription Plans</h2>

                    <div class="grid grid-cols-1 gap-4 mb-8">
                        <!-- Basic Plan -->
                        <div class="plan-card glass rounded-2xl p-6 cursor-pointer" onclick="selectPlan('basic')">
                            <h3 class="text-xl font-bold text-white mb-2">Basic</h3>
                            <p class="text-3xl font-bold text-white mb-2">৳50</p>
                            <p class="text-white text-opacity-80 text-sm mb-4">1 Month</p>
                            <ul class="text-white text-sm space-y-2 mb-4">
                                <li>✅ Ad Free</li>
                                <li>✅ Smooth & Fast</li>
                            </ul>
                        </div>

                        <!-- Premium Plan -->
                        <div class="plan-card glass rounded-2xl p-6 cursor-pointer" onclick="selectPlan('premium')">
                            <h3 class="text-xl font-bold text-white mb-2">Premium</h3>
                            <p class="text-3xl font-bold text-white mb-2">৳200</p>
                            <p class="text-white text-opacity-80 text-sm mb-4">6 Months</p>
                            <ul class="text-white text-sm space-y-2 mb-4">
                                <li>✅ Ad Free</li>
                                <li>✅ Smooth & Fast</li>
                                <li>✅ Priority Support</li>
                            </ul>
                        </div>

                        <!-- Pro Plan -->
                        <div class="plan-card glass rounded-2xl p-6 cursor-pointer" onclick="selectPlan('pro')">
                            <h3 class="text-xl font-bold text-white mb-2">Pro</h3>
                            <p class="text-3xl font-bold text-white mb-2">৳500</p>
                            <p class="text-white text-opacity-80 text-sm mb-4">12 Months</p>
                            <ul class="text-white text-sm space-y-2 mb-4">
                                <li>✅ Ad Free</li>
                                <li>✅ Smooth & Fast</li>
                                <li>✅ Priority Support</li>
                                <li>✅ Premium Features</li>
                            </ul>
                        </div>

                        <!-- Ultra Plan -->
                        <div class="plan-card glass rounded-2xl p-6 cursor-pointer" onclick="selectPlan('ultra')">
                            <h3 class="text-xl font-bold text-white mb-2">Ultra</h3>
                            <p class="text-3xl font-bold text-white mb-2">৳1500</p>
                            <p class="text-white text-opacity-80 text-sm mb-4">Unlimited</p>
                            <ul class="text-white text-sm space-y-2 mb-4">
                                <li>✅ Ad Free</li>
                                <li>✅ Smooth & Fast</li>
                                <li>✅ Premium Support</li>
                                <li>✅ All Features</li>
                                <li>✅ Lifetime Access</li>
                            </ul>
                        </div>
                    </div>

                    <button onclick="proceedPayment()" class="w-full py-4 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold text-lg btn-pulse" id="proceedBtn" style="display: none;" data-en="Proceed to Payment" data-bn="পেমেন্টে যান">Proceed to Payment</button>

                    <button onclick="showPage('profile')" class="w-full py-3 mt-4 bg-white bg-opacity-20 text-white rounded-xl font-bold btn-pulse" data-en="Back to Profile" data-bn="প্রোফাইলে ফিরে যান">Back to Profile</button>
                </div>
            </div>
        </div>

        <!-- Payment Page -->
        <div id="paymentPage" class="page-content pb-24">
            <div class="p-6">
                <div class="glass rounded-3xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-6" id="paymentTitle">Payment</h2>

                    <div class="space-y-4 mb-6">
                        <h3 class="text-lg font-bold text-white" data-en="Select Payment Method" data-bn="পেমেন্ট মেথড নির্বাচন করুন">Select Payment Method</h3>
                        
                        <div class="space-y-3">
                            <button onclick="selectPaymentMethod('bkash')" class="w-full glass rounded-2xl p-4 text-left flex items-center justify-between btn-pulse" id="bkashBtn">
                                <span class="text-white font-bold">📱 Bkash</span>
                                <span class="text-white text-opacity-80">01922979250</span>
                            </button>
                            <button onclick="selectPaymentMethod('nagad')" class="w-full glass rounded-2xl p-4 text-left flex items-center justify-between btn-pulse" id="nagadBtn">
                                <span class="text-white font-bold">📱 Nagad</span>
                                <span class="text-white text-opacity-80">01922979250</span>
                            </button>
                            <button onclick="selectPaymentMethod('rocket')" class="w-full glass rounded-2xl p-4 text-left flex items-center justify-between btn-pulse" id="rocketBtn">
                                <span class="text-white font-bold">📱 Rocket</span>
                                <span class="text-white text-opacity-80">019229792500</span>
                            </button>
                            <button onclick="selectPaymentMethod('upay')" class="w-full glass rounded-2xl p-4 text-left flex items-center justify-between btn-pulse" id="upayBtn">
                                <span class="text-white font-bold">📱 Upay</span>
                                <span class="text-white text-opacity-80">01922979250</span>
                            </button>
                        </div>
                    </div>

                    <hr class="border-white border-opacity-20 my-6">

                    <div id="paymentForm" style="display: none;" class="space-y-4">
                        <div>
                            <label class="text-white mb-2 block" data-en="Account Number" data-bn="একাউন্ট নম্বর">Account Number</label>
                            <input type="text" id="accountNumber" placeholder="Your Account Number" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Transaction ID" data-bn="ট্রানজেকশন আইডি">Transaction ID</label>
                            <input type="text" id="transactionId" placeholder="Your Transaction ID" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Last 4 Digits of Your Number" data-bn="আপনার নম্বরের শেষ ४ ডিজিট">Last 4 Digits of Your Number</label>
                            <input type="text" id="lastFourDigits" maxlength="4" placeholder="1234" class="w-full px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                        </div>

                        <div>
                            <label class="text-white mb-2 block" data-en="Screenshot Image URL" data-bn="স্ক্রিনশট ইমেজ URL">Screenshot Image URL</label>
                            <div class="flex gap-2">
                                <input type="text" id="screenshotUrl" placeholder="Paste image URL from postimages.org" class="flex-1 px-4 py-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-60 outline-none">
                                <button onclick="showImageUploadInfo()" class="px-4 py-3 bg-blue-500 text-white rounded-xl font-bold btn-pulse">?</button>
                            </div>
                        </div>

                        <button onclick="submitPayment()" class="w-full py-4 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold text-lg btn-pulse" data-en="Submit Payment" data-bn="পেমেন্ট জমা দিন">Submit Payment</button>
                    </div>

                    <button onclick="showPage('subscription')" class="w-full py-3 mt-4 bg-white bg-opacity-20 text-white rounded-xl font-bold btn-pulse" data-en="Back to Plans" data-bn="প্ল্যানে ফিরে যান">Back to Plans</button>
                </div>
            </div>
        </div>
        
        <!-- Bottom Navigation -->
        <div class="fixed bottom-0 left-0 right-0 glass border-t border-white border-opacity-20 px-4 py-3">
            <div class="flex justify-around items-center max-w-md mx-auto">
                <div onclick="showPage('home')" class="nav-item active flex flex-col items-center cursor-pointer btn-pulse">
                    <svg class="w-6 h-6 text-white mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                    <span class="text-white text-xs" data-en="Home" data-bn="হোম">Home</span>
                </div>
                <div onclick="showPage('overtime')" class="nav-item flex flex-col items-center cursor-pointer btn-pulse">
                    <svg class="w-6 h-6 text-white mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    <span class="text-white text-xs" data-en="Overtime" data-bn="ওভারটাইম">Overtime</span>
                </div>
                <div onclick="showPage('calculator')" class="nav-item flex flex-col items-center cursor-pointer btn-pulse">
                    <svg class="w-6 h-6 text-white mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    <span class="text-white text-xs" data-en="Calculator" data-bn="ক্যালকুলেটর">Calculator</span>
                </div>
                <div onclick="showPage('list')" class="nav-item flex flex-col items-center cursor-pointer btn-pulse">
                    <svg class="w-6 h-6 text-white mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                    </svg>
                    <span class="text-white text-xs" data-en="List" data-bn="তালিকা">List</span>
                </div>
                <div onclick="showPage('profile')" class="nav-item flex flex-col items-center cursor-pointer btn-pulse">
                    <svg class="w-6 h-6 text-white mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <span class="text-white text-xs" data-en="Profile" data-bn="প্রোফাইল">Profile</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="attendanceBonusModal" class="modal">
        <div class="glass rounded-3xl p-8 max-w-md mx-4">
            <h2 class="text-2xl font-bold text-white mb-4 text-center" data-en="Attendance Bonus" data-bn="হাজিরা বোনাস">Attendance Bonus</h2>
            <p class="text-white mb-6 text-center" data-en="Do you have attendance bonus?" data-bn="আপনার কাছে হাজিরা বোনাস আছে কি?">Do you have attendance bonus?</p>
            <div class="space-y-3">
                <button onclick="calculateWithBonus(true)" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold btn-pulse" data-en="Yes" data-bn="হ্যাঁ">Yes</button>
                <button onclick="calculateWithBonus(false)" class="w-full py-3 bg-white bg-opacity-20 text-white rounded-xl font-bold btn-pulse" data-en="No" data-bn="না">No</button>
            </div>
        </div>
    </div>

    <div id="welcomeModal" class="modal">
        <div class="glass rounded-3xl p-8 max-w-md mx-4 max-h-96 overflow-y-auto">
            <h2 class="text-2xl font-bold text-white mb-4 text-center" data-en="Welcome to Garments OT" data-bn="গার্মেন্টস OT এ স্বাগতম">Welcome to Garments OT</h2>
            <div class="text-white space-y-3 text-sm">
                <div class="bg-white bg-opacity-10 rounded-lg p-3">
                    <h3 class="font-bold mb-2">✨ Features:</h3>
                    <ul class="list-disc list-inside space-y-1">
                        <li data-en="Track overtime easily" data-bn="সহজেই ওভারটাইম ট্র্যাক করুন">Track overtime easily</li>
                        <li data-en="Automatic salary calculation" data-bn="স্বয়ংক্রিয় বেতন গণনা">Automatic salary calculation</li>
                        <li data-en="Attendance bonus: ৳725" data-bn="হাজিরা বোনাস: ৳725">Attendance bonus: ৳725</li>
                        <li data-en="Tiffin & Night Bill tracking" data-bn="টিফিন ও নাইট বিল ট্র্যাকিং">Tiffin & Night Bill tracking</li>
                        <li data-en="Bilingual interface" data-bn="দ্বিভাষিক ইন্টারফেস">Bilingual interface</li>
                    </ul>
                </div>
            </div>
            <button onclick="closeWelcomeModal()" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold mt-6 btn-pulse" data-en="OK" data-bn="ঠিক আছে">OK</button>
        </div>
    </div>

    <div id="imageUploadModal" class="modal">
        <div class="glass rounded-3xl p-8 max-w-md mx-4">
            <h2 class="text-2xl font-bold text-white mb-4" data-en="How to Upload Image" data-bn="ইমেজ কিভাবে আপলোড করবেন">How to Upload Image</h2>
            <div class="text-white space-y-3 text-sm">
                <p>1. Go to https://postimages.org/</p>
                <p>2. Upload your screenshot</p>
                <p>3. Copy the image URL</p>
                <p>4. Paste it in the URL field above</p>
            </div>
            <button onclick="closeModal('imageUploadModal')" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold mt-6 btn-pulse" data-en="OK" data-bn="ঠিক আছে">OK</button>
        </div>
    </div>

    <div id="subscriptionPendingModal" class="modal">
        <div class="glass rounded-3xl p-8 max-w-md mx-4 text-center">
            <div class="text-6xl mb-4">⏳</div>
            <h2 class="text-2xl font-bold text-white mb-4" data-en="Under Review" data-bn="রিভিউয়ের অধীন">Under Review</h2>
            <p class="text-white mb-2" data-en="Your subscription is being reviewed" data-bn="আপনার সাবস্ক্রিপশন রিভিউ হচ্ছে">Your subscription is being reviewed</p>
            <p class="text-white mb-6" data-en="We will approve it within 24 hours" data-bn="আমরা এটি २४ ঘন্টায় approve করব">We will approve it within 24 hours</p>
            <button onclick="downloadProApp()" class="w-full py-4 bg-gradient-to-r from-purple-400 to-pink-400 text-white rounded-xl font-bold btn-pulse mb-3" data-en="📲 Download Pro App" data-bn="📲 প্রো অ্যাপ ডাউনলোড করুন">📲 Download Pro App</button>
            <button onclick="closeModal('subscriptionPendingModal')" class="w-full py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-xl font-bold btn-pulse" data-en="OK" data-bn="ঠিক আছে">OK</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCOets_8BQkDex92Qrb21uhzrAVRXnPXms",
            authDomain: "overtime-calculator-8c926.firebaseapp.com",
            databaseURL: "https://overtime-calculator-8c926-default-rtdb.firebaseio.com",
            projectId: "overtime-calculator-8c926",
            storageBucket: "overtime-calculator-8c926.firebasestorage.app",
            messagingSenderId: "1044899871918",
            appId: "1:1044899871918:web:5493af45b9927bafaac13f"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        
        // Global Variables
        let currentUser = null;
        let currentLanguage = 'en';
        let isDarkMode = false;
        let currentTheme = 'default';
        let selectedPlan = null;
        let selectedPaymentMethod = null;
        
        // Translations
        const translations = {
            en: {
                noHolidays: 'No public holidays this month',
                fillAllFields: 'Please fill all fields',
                enterValidPhone: 'Please enter valid 11 digit phone number',
                enterName: 'Please enter your name',
                selectPosition: 'Please select position',
                selectGrade: 'Please select grade',
                enterValidSalary: 'Please enter valid salary',
                enter4DigitPin: 'Please enter 4 digit PIN',
                signupSuccess: 'Signup successful! Please login now.',
                enterPhonePin: 'Please enter phone and PIN',
                wrongPhonePin: 'Wrong phone number or PIN',
                enterOTHours: 'Please enter overtime hours',
                otAdded: 'Overtime added!',
                confirmDelete: 'Are you sure you want to delete?',
                confirmLogout: 'Are you sure you want to logout?',
                day: 'Day',
                night: 'Night',
                friday: 'Friday',
                absent: 'Absent',
                open: 'Open',
                closed: 'Closed',
                hours: 'hours',
                oldPinWrong: 'Old PIN is wrong',
                pinsNotMatch: 'PINs do not match',
                pinChanged: 'PIN changed successfully',
                editSuccess: 'Profile updated successfully',
                editLocked: 'You can edit after 15 days',
                tiffin: 'Tiffin Bill',
                night: 'Night Bill',
                billAdded: 'Bill added successfully!',
                selectBillType: 'Please select bill type',
                enterBillAmount: 'Please enter bill amount',
                selectPaymentMethod: 'Please select payment method',
                fillPaymentDetails: 'Please fill all payment details',
                paymentSubmitted: 'Payment submitted! Under review for 24 hours.'
            },
            bn: {
                noHolidays: 'এই মাসে কোন সরকারি ছুটি নেই',
                fillAllFields: 'সকল তথ্য পূরণ করুন',
                enterValidPhone: 'সঠিক ११ ডিজিটের ফোন নম্বর দিন',
                enterName: 'আপনার নাম লিখুন',
                selectPosition: 'পদবি নির্বাচন করুন',
                selectGrade: 'গ্রেড নির্বাচন করুন',
                enterValidSalary: 'সঠিক বেতন লিখুন',
                enter4DigitPin: '४ ডিজিটের পিন নম্বর দিন',
                signupSuccess: 'সাইন আপ সফল হয়েছে! এখন লগইন করুন।',
                enterPhonePin: 'ফোন নম্বর এবং পিন দিন',
                wrongPhonePin: 'ভুল ফোন নম্বর বা পিন',
                enterOTHours: 'ওভারটাইম ঘণ্টা দিন',
                otAdded: 'ওভারটাইম যোগ হয়েছে!',
                confirmDelete: 'মুছে ফেলতে চান?',
                confirmLogout: 'লগ আউট করতে চান?',
                day: 'দিন',
                night: 'রাত',
                friday: 'শুক্রবার',
                absent: 'অনুপস্থিত',
                open: 'খোলা',
                closed: 'বন্ধ',
                hours: 'ঘণ্টা',
                oldPinWrong: 'পুরাতন পিন ভুল',
                pinsNotMatch: 'পিন মিলছে না',
                pinChanged: 'পিন পরিবর্তন হয়েছে',
                editSuccess: 'প্রোফাইল আপডেট হয়েছে',
                editLocked: '१५ দিন পরে সম্পাদনা করতে পারবেন',
                tiffin: 'টিফিন বিল',
                night: 'নাইট বিল',
                billAdded: 'বিল যোগ হয়েছে!',
                selectBillType: 'বিল ধরন নির্বাচন করুন',
                enterBillAmount: 'বিল পরিমাণ দিন',
                selectPaymentMethod: 'পেমেন্ট মেথড নির্বাচন করুন',
                fillPaymentDetails: 'সকল পেমেন্ট তথ্য দিন',
                paymentSubmitted: 'পেমেন্ট জমা দেওয়া হয়েছে! २४ ঘন্টায় রিভিউ হবে।'
            }
        };
        
        // Theme configurations
        const themes = {
            default: { from: '#667eea', to: '#764ba2' },
            ocean: { from: '#2E3192', to: '#1BFFFF' },
            sunset: { from: '#FF512F', to: '#F09819' },
            forest: { from: '#134E5E', to: '#71B280' },
            rose: { from: '#F857A6', to: '#FF5858' },
            night: { from: '#000428', to: '#004e92' },
            candy: { from: '#D3CCE3', to: '#E9E4F0' },
            mint: { from: '#00d2ff', to: '#3a7bd5' },
            fire: { from: '#f12711', to: '#f5af19' },
            purple: { from: '#8E2DE2', to: '#4A00E0' }
        };
        
        // Check if user is logged in
        window.onload = function() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
                checkWelcomeNotification();
                checkSubscriptionStatus();
            }
            
            // Check dark mode
            const savedDarkMode = localStorage.getItem('darkMode');
            if (savedDarkMode === 'true') {
                document.body.classList.add('dark');
                isDarkMode = true;
                updateDarkModeToggle();
            }
            
            // Check language
            const savedLang = localStorage.getItem('language');
            if (savedLang) {
                currentLanguage = savedLang;
                updateLanguage();
            }
            
            // Check theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                currentTheme = savedTheme;
                changeTheme(savedTheme);
            }
            
            // Set today's date as default
            if (document.getElementById('otDate')) {
                document.getElementById('otDate').valueAsDate = new Date();
                document.getElementById('billDate').valueAsDate = new Date();
            }
            
            // Set current month for list page
            const today = new Date();
            const monthString = today.toISOString().substring(0, 7);
            if (document.getElementById('listMonth')) {
                document.getElementById('listMonth').value = monthString;
            }
        };
        
        // Check Subscription Status from Firebase
        function checkSubscriptionStatus() {
            if (navigator.onLine && currentUser && currentUser.phone) {
                database.ref('subscriptions/' + currentUser.phone).once('value')
                    .then((snapshot) => {
                        const firebaseSub = snapshot.val();
                        if (firebaseSub && (firebaseSub.status === 'Yes' || firebaseSub.status === 'approved')) {
                            // Subscription is approved
                            currentUser.subscriptionStatus = firebaseSub.plan;
                            localStorage.setItem('currentUser', JSON.stringify(currentUser));
                            localStorage.setItem('subscription_' + currentUser.phone, JSON.stringify(firebaseSub));
                            updateSubscriptionDisplay();
                        }
                    })
                    .catch(error => console.error('Firebase subscription check error:', error));
            }
        }
        
        // Update Subscription Display
        function updateSubscriptionDisplay() {
            const subscription = localStorage.getItem('subscription_' + currentUser.phone);
            const statusEl = document.getElementById('subscriptionStatus');
            
            if (subscription) {
                const sub = JSON.parse(subscription);
                if (sub.status === 'approved' || sub.status === 'Yes') {
                    const planNames = { basic: 'Basic', premium: 'Premium', pro: 'Pro', ultra: 'Ultra' };
                    statusEl.innerHTML = `<span id="statusText">${planNames[sub.plan]} Plan Active</span>`;
                    statusEl.style.display = 'block';
                } else if (sub.status === 'pending') {
                    statusEl.innerHTML = `<span id="statusText">Subscription Pending</span>`;
                    statusEl.style.display = 'block';
                }
            }
        }
        
        // Check Welcome Notification
        function checkWelcomeNotification() {
            const lastWelcome = localStorage.getItem('lastWelcomeNotification');
            const now = new Date().getTime();
            
            if (!lastWelcome || (now - parseInt(lastWelcome)) > 24 * 60 * 60 * 1000) {
                document.getElementById('welcomeModal').classList.add('active');
                localStorage.setItem('lastWelcomeNotification', now.toString());
            }
        }

        function closeWelcomeModal() {
            document.getElementById('welcomeModal').classList.remove('active');
        }

        function downloadProApp() {
            window.open('https://github.com/garments-ot/pro-app', '_blank');
        }
        
        // Update Language
        function updateLanguage() {
            document.querySelectorAll('[data-en]').forEach(element => {
                if (currentLanguage === 'bn' && element.hasAttribute('data-bn')) {
                    element.textContent = element.getAttribute('data-bn');
                } else if (currentLanguage === 'en' && element.hasAttribute('data-en')) {
                    element.textContent = element.getAttribute('data-en');
                }
            });
            
            document.querySelectorAll('[data-en-placeholder]').forEach(element => {
                if (currentLanguage === 'bn' && element.hasAttribute('data-bn-placeholder')) {
                    element.placeholder = element.getAttribute('data-bn-placeholder');
                } else if (currentLanguage === 'en' && element.hasAttribute('data-en-placeholder')) {
                    element.placeholder = element.getAttribute('data-en-placeholder');
                }
            });
            
            document.getElementById('currentLang').textContent = currentLanguage === 'en' ? 'English' : 'বাংলা';
        }
        
        // Change Theme
        function changeTheme(themeName) {
            currentTheme = themeName;
            const theme = themes[themeName];
            document.documentElement.style.setProperty('--bg-from', theme.from);
            document.documentElement.style.setProperty('--bg-to', theme.to);
            
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.remove('active');
            });
            document.querySelector(`[data-theme="${themeName}"]`).classList.add('active');
            
            localStorage.setItem('theme', themeName);
        }
        
        // Toggle Auth Page Language
        function toggleAuthLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'bn' : 'en';
            localStorage.setItem('language', currentLanguage);
            updateLanguage();
            document.getElementById('authLangText').textContent = currentLanguage === 'en' ? 'EN' : 'বাং';
        }
        
        // Signup Steps
        let currentStep = 1;
        
        function nextStep(step) {
            if (step === 2) {
                const phone = document.getElementById('signupPhone').value;
                if (!phone || phone.length !== 11) {
                    alert(translations[currentLanguage].enterValidPhone);
                    return;
                }
            } else if (step === 3) {
                const name = document.getElementById('signupName').value;
                if (!name) {
                    alert(translations[currentLanguage].enterName);
                    return;
                }
            } else if (step === 4) {
                const position = document.getElementById('signupPosition').value;
                if (!position) {
                    alert(translations[currentLanguage].selectPosition);
                    return;
                }
            } else if (step === 5) {
                const grade = document.getElementById('signupGrade').value;
                if (!grade) {
                    alert(translations[currentLanguage].selectGrade);
                    return;
                }
            } else if (step === 6) {
                const salary = document.getElementById('signupSalary').value;
                if (!salary || salary < 0) {
                    alert(translations[currentLanguage].enterValidSalary);
                    return;
                }
            }
            
            document.getElementById('step' + currentStep).classList.remove('active');
            currentStep = step;
            document.getElementById('step' + currentStep).classList.add('active');
        }
        
        // Show Signup
        function showSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            currentStep = 1;
            document.querySelectorAll('.step-form').forEach(s => s.classList.remove('active'));
            document.getElementById('step1').classList.add('active');
        }
        
        // Show Login
        function showLogin() {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }
        
        // Signup Function
        async function signup() {
            const phone = document.getElementById('signupPhone').value;
            const name = document.getElementById('signupName').value;
            const position = document.getElementById('signupPosition').value;
            const grade = document.getElementById('signupGrade').value;
            const salary = document.getElementById('signupSalary').value;
            const pin = document.getElementById('signupPin').value;
            
            if (!pin || pin.length !== 4) {
                alert(translations[currentLanguage].enter4DigitPin);
                return;
            }
            
            const userData = {
                phone: phone,
                name: name,
                position: position,
                grade: grade,
                salary: parseFloat(salary),
                pin: pin,
                createdAt: new Date().toISOString(),
                subscriptionStatus: 'free'
            };
            
            // Save to localStorage
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            users[phone] = userData;
            localStorage.setItem('users', JSON.stringify(users));
            
            // Try to save to Firebase
            if (navigator.onLine) {
                try {
                    const email = phone + '@garments-ot.com';
                    const password = phone + pin;
                    
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    
                    await userCredential.user.updateProfile({
                        displayName: name
                    });
                    
                    await database.ref('users/' + phone).set({
                        ...userData,
                        uid: userCredential.user.uid
                    });
                } catch (error) {
                    console.error('Firebase error:', error);
                    if (error.code === 'auth/email-already-in-use') {
                        await database.ref('users/' + phone).set(userData).catch(() => {});
                    }
                }
            }
            
            alert(translations[currentLanguage].signupSuccess);
            showLogin();
            
            document.getElementById('signupPhone').value = '';
            document.getElementById('signupName').value = '';
            document.getElementById('signupPosition').value = '';
            document.getElementById('signupGrade').value = '';
            document.getElementById('signupSalary').value = '';
            document.getElementById('signupPin').value = '';
            currentStep = 1;
        }
        
        // Login Function
        function login() {
            const phone = document.getElementById('loginPhone').value;
            const pin = document.getElementById('loginPin').value;
            
            if (!phone || !pin) {
                alert(translations[currentLanguage].enterPhonePin);
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const localUser = users[phone];
            
            if (localUser && localUser.pin === pin) {
                currentUser = localUser;
                localStorage.setItem('currentUser', JSON.stringify(localUser));
                showMainApp();
                checkWelcomeNotification();
                checkSubscriptionStatus();
                
                if (navigator.onLine) {
                    database.ref('users/' + phone).once('value')
                        .then((snapshot) => {
                            const firebaseUser = snapshot.val();
                            if (firebaseUser) {
                                users[phone] = firebaseUser;
                                localStorage.setItem('users', JSON.stringify(users));
                                currentUser = firebaseUser;
                                localStorage.setItem('currentUser', JSON.stringify(firebaseUser));
                                loadUserData();
                            }
                        })
                        .catch(error => console.error('Firebase sync error:', error));
                }
            } else if (navigator.onLine) {
                database.ref('users/' + phone).once('value')
                    .then((snapshot) => {
                        const user = snapshot.val();
                        if (user && user.pin === pin) {
                            currentUser = user;
                            localStorage.setItem('currentUser', JSON.stringify(user));
                            users[phone] = user;
                            localStorage.setItem('users', JSON.stringify(users));
                            showMainApp();
                            checkWelcomeNotification();
                            checkSubscriptionStatus();
                        } else {
                            alert(translations[currentLanguage].wrongPhonePin);
                        }
                    })
                    .catch((error) => {
                        console.error('Firebase error:', error);
                        alert(translations[currentLanguage].wrongPhonePin);
                    });
            } else {
                alert(translations[currentLanguage].wrongPhonePin);
            }
        }
        
        // Show Main App
        function showMainApp() {
            document.getElementById('authPage').classList.remove('active');
            document.getElementById('mainApp').classList.add('active');
            document.getElementById('loginPhone').value = '';
            document.getElementById('loginPin').value = '';
            loadUserData();
            loadHolidays();
            loadOTList();
            loadBillList();
        }
        
        // Load User Data
        function loadUserData() {
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profilePhone').textContent = currentUser.phone;
            document.getElementById('profilePosition').textContent = currentUser.position;
            document.getElementById('profileGrade').textContent = currentUser.grade;
            document.getElementById('profileInitial').textContent = currentUser.name.charAt(0).toUpperCase();
            
            const otData = JSON.parse(localStorage.getItem('overtime_' + currentUser.phone) || '[]');
            let totalOT = 0;
            
            otData.forEach((ot) => {
                if (ot.hours) {
                    totalOT += parseFloat(ot.hours);
                }
            });
            
            document.getElementById('totalOT').textContent = totalOT.toFixed(1);
            document.getElementById('calcTotalOT').textContent = totalOT.toFixed(1) + ' ' + (currentLanguage === 'en' ? 'hours' : 'ঘণ্টা');
            
            const basicSalary = currentUser.salary * 0.536;
            const otRate = ((basicSalary / 26 / 8) * 2);
            const otAmount = totalOT * otRate;
            const attendanceBonus = 725;
            
            // Calculate bills
            const billData = JSON.parse(localStorage.getItem('bills_' + currentUser.phone) || '[]');
            let totalBills = 0;
            billData.forEach((bill) => {
                if (bill.amount) {
                    totalBills += parseFloat(bill.amount);
                }
            });
            
            const estimatedSalary = currentUser.salary + otAmount + attendanceBonus + totalBills;
            
            document.getElementById('estimatedSalary').textContent = '৳' + Math.round(estimatedSalary);
            document.getElementById('calcTotalSalary').textContent = '৳' + Math.round(estimatedSalary);
            document.getElementById('otherBenefits').textContent = '৳' + Math.round(totalBills);
        }
        
        // Load Holidays
        function loadHolidays() {
            const holidays = {
                '2025-01': [{ date: '1 January', dateBn: '१ জানুয়ারি', name: 'New Year\'s Day', nameBn: 'নববর্ষ' }],
                '2025-02': [{ date: '21 February', dateBn: '२१ ফেব্রুয়ারি', name: 'International Mother Language Day', nameBn: 'আন্তর্জাতিক মাতৃভাষা দিবস' }],
                '2025-03': [
                    { date: '17 March', dateBn: '१७ মার্চ', name: 'Birthday of Bangabandhu', nameBn: 'জাতির পিতার জন্মদিন' },
                    { date: '26 March', dateBn: '२६ মার্চ', name: 'Independence Day', nameBn: 'স্বাধীনতা দিবস' }
                ],
                '2025-04': [{ date: '14 April', dateBn: '१४ এপ্রিল', name: 'Pohela Boishakh', nameBn: 'পহেলা বৈশাখ' }],
                '2025-05': [{ date: '1 May', dateBn: '१ মে', name: 'May Day', nameBn: 'মে দিবস' }],
                '2025-08': [{ date: '15 August', dateBn: '१५ আগস্ট', name: 'National Mourning Day', nameBn: 'জাতীয় শোক দিবস' }],
                '2025-12': [
                    { date: '16 December', dateBn: '१६ ডিসেম্বর', name: 'Victory Day', nameBn: 'বিজয় দিবস' },
                    { date: '25 December', dateBn: '२५ ডিসেম্বর', name: 'Christmas Day', nameBn: 'বড়দিন' }
                ]
            };
            
            const currentMonth = new Date().toISOString().substring(0, 7);
            const currentHolidays = holidays[currentMonth] || [];
            
            const holidaysList = document.getElementById('holidaysList');
            if (currentHolidays.length === 0) {
                holidaysList.innerHTML = `<p class="text-white text-opacity-70">${translations[currentLanguage].noHolidays}</p>`;
            } else {
                holidaysList.innerHTML = currentHolidays.map(h => `
                    <div class="bg-white bg-opacity-10 rounded-xl p-3 flex items-center">
                        <span class="text-2xl mr-3">📅</span>
                        <div>
                            <p class="text-white font-medium">${currentLanguage === 'bn' ? h.nameBn : h.name}</p>
                            <p class="text-white text-opacity-70 text-sm">${currentLanguage === 'bn' ? h.dateBn : h.date}</p>
                        </div>
                    </div>
                `).join('');
            }
        }
        
        // Handle OT Type Change
        function handleOTTypeChange() {
            const otType = document.getElementById('otType').value;
            const fridayOptions = document.getElementById('fridayOptions');
            const otHoursDiv = document.getElementById('otHoursDiv');
            
            if (otType === 'friday') {
                fridayOptions.style.display = 'block';
                otHoursDiv.style.display = 'none';
            } else if (otType === 'absent') {
                fridayOptions.style.display = 'none';
                otHoursDiv.style.display = 'none';
            } else {
                fridayOptions.style.display = 'none';
                otHoursDiv.style.display = 'block';
            }
        }
        
        // Handle Friday Change
        function handleFridayChange() {
            const fridayType = document.getElementById('fridayType').value;
            const otHoursDiv = document.getElementById('otHoursDiv');
            
            if (fridayType === 'open') {
                otHoursDiv.style.display = 'block';
            } else {
                otHoursDiv.style.display = 'none';
            }
        }
        
        // Add OT
        function addOT() {
            const date = document.getElementById('otDate').value;
            const type = document.getElementById('otType').value;
            let hours = 0;
            
            if (!date || !type) {
                alert(translations[currentLanguage].fillAllFields);
                return;
            }
            
            if (type === 'friday') {
                const fridayType = document.getElementById('fridayType').value;
                if (!fridayType) {
                    alert('Please select Friday status');
                    return;
                }
                if (fridayType === 'open') {
                    hours = parseFloat(document.getElementById('otHours').value) || 0;
                    if (hours === 0) {
                        alert(translations[currentLanguage].enterOTHours);
                        return;
                    }
                }
            } else if (type !== 'absent') {
                hours = parseFloat(document.getElementById('otHours').value) || 0;
                if (hours === 0) {
                    alert(translations[currentLanguage].enterOTHours);
                    return;
                }
            }
            
            const otEntry = {
                id: Date.now().toString(),
                date: date,
                type: type,
                hours: hours,
                fridayType: type === 'friday' ? document.getElementById('fridayType').value : null,
                timestamp: new Date().toISOString()
            };
            
            const otData = JSON.parse(localStorage.getItem('overtime_' + currentUser.phone) || '[]');
            otData.push(otEntry);
            localStorage.setItem('overtime_' + currentUser.phone, JSON.stringify(otData));
            
            database.ref('overtime/' + currentUser.phone + '/' + otEntry.id).set(otEntry)
                .catch(error => console.error('Firebase error:', error));
            
            alert(translations[currentLanguage].otAdded);
            
            document.getElementById('otType').value = '';
            document.getElementById('otHours').value = '';
            document.getElementById('fridayType').value = '';
            document.getElementById('fridayOptions').style.display = 'none';
            document.getElementById('otHoursDiv').style.display = 'block';
            
            loadUserData();
            loadOTList();
        }

        // Add Bill
        function addBill() {
            const date = document.getElementById('billDate').value;
            const type = document.getElementById('billType').value;
            const amount = parseFloat(document.getElementById('billAmount').value) || 0;
            
            if (!date || !type) {
                alert(translations[currentLanguage].selectBillType);
                return;
            }
            
            if (amount === 0) {
                alert(translations[currentLanguage].enterBillAmount);
                return;
            }
            
            const billEntry = {
                id: Date.now().toString(),
                date: date,
                type: type,
                amount: amount,
                timestamp: new Date().toISOString()
            };
            
            const billData = JSON.parse(localStorage.getItem('bills_' + currentUser.phone) || '[]');
            billData.push(billEntry);
            localStorage.setItem('bills_' + currentUser.phone, JSON.stringify(billData));
            
            database.ref('bills/' + currentUser.phone + '/' + billEntry.id).set(billEntry)
                .catch(error => console.error('Firebase error:', error));
            
            alert(translations[currentLanguage].billAdded);
            
            document.getElementById('billDate').valueAsDate = new Date();
            document.getElementById('billType').value = '';
            document.getElementById('billAmount').value = '';
            
            loadUserData();
            loadBillList();
        }
        
        // Calculate Salary
        function calculateSalary() {
            document.getElementById('attendanceBonusModal').classList.add('active');
        }

        function calculateWithBonus(hasBonus) {
            document.getElementById('attendanceBonusModal').classList.remove('active');
            
            const totalSalary = currentUser.salary;
            const basic = totalSalary * 0.536;
            const houseRent = totalSalary * 0.30;
            const medical = totalSalary * 0.05;
            
            const otRate = ((basic / 26 / 8) * 2);
            
            const otData = JSON.parse(localStorage.getItem('overtime_' + currentUser.phone) || '[]');
            let totalOTHours = 0;
            
            otData.forEach((ot) => {
                if (ot.hours) {
                    totalOTHours += parseFloat(ot.hours);
                }
            });
            
            const otAmount = totalOTHours * otRate;
            const attendanceBonus = hasBonus ? 725 : 0;
            
            // Calculate bills
            const billData = JSON.parse(localStorage.getItem('bills_' + currentUser.phone) || '[]');
            let totalBills = 0;
            billData.forEach((bill) => {
                if (bill.amount) {
                    totalBills += parseFloat(bill.amount);
                }
            });
            
            const finalSalary = totalSalary + otAmount + attendanceBonus + totalBills;
            
            document.getElementById('calcTotalSalary').textContent = '৳' + Math.round(finalSalary);
            document.getElementById('basicSalary').textContent = '৳' + Math.round(basic);
            document.getElementById('houseRent').textContent = '৳' + Math.round(houseRent);
            document.getElementById('medical').textContent = '৳' + Math.round(medical);
            document.getElementById('otRate').textContent = '৳' + otRate.toFixed(2);
            document.getElementById('otAmount').textContent = '৳' + Math.round(otAmount);
            document.getElementById('attendanceBonusCalc').textContent = '৳' + attendanceBonus;
            document.getElementById('tiffinBillCalc').textContent = '৳' + Math.round(billData.filter(b => b.type === 'tiffin').reduce((sum, b) => sum + b.amount, 0));
            document.getElementById('nightBillCalc').textContent = '৳' + Math.round(billData.filter(b => b.type === 'night').reduce((sum, b) => sum + b.amount, 0));
            
            document.getElementById('salaryBreakdown').style.display = 'block';
        }
        
        // Load OT List
        function loadOTList() {
            const selectedMonth = document.getElementById('listMonth').value;
            const otListTable = document.getElementById('otListTable');
            otListTable.innerHTML = '';
            
            const otData = JSON.parse(localStorage.getItem('overtime_' + currentUser.phone) || '[]');
            
            const filteredData = otData.filter(ot => ot.date.startsWith(selectedMonth));
            
            if (filteredData.length === 0) {
                otListTable.innerHTML = `<tr><td colspan="4" class="py-4 text-center text-white text-opacity-70">${currentLanguage === 'bn' ? 'কোন তথ্য নেই' : 'No data found'}</td></tr>`;
                document.getElementById('summaryTotalOT').textContent = '0';
                document.getElementById('summaryDay').textContent = '0';
                document.getElementById('summaryNight').textContent = '0';
                document.getElementById('summaryFriday').textContent = '0';
                return;
            }
            
            filteredData.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let totalOT = 0;
            let dayCount = 0;
            let nightCount = 0;
            let fridayCount = 0;
            
            filteredData.forEach((ot) => {
                if (ot.hours) totalOT += parseFloat(ot.hours);
                if (ot.type === 'day') dayCount++;
                if (ot.type === 'night') nightCount++;
                if (ot.type === 'friday') fridayCount++;
                
                const typeText = {
                    'day': translations[currentLanguage].day,
                    'night': translations[currentLanguage].night,
                    'friday': translations[currentLanguage].friday + (ot.fridayType === 'open' ? ` (${translations[currentLanguage].open})` : ` (${translations[currentLanguage].closed})`),
                    'absent': translations[currentLanguage].absent
                };
                
                const row = document.createElement('tr');
                row.classList.add('border-b', 'border-white', 'border-opacity-10');
                row.innerHTML = `
                    <td class="py-3">${new Date(ot.date).toLocaleDateString(currentLanguage === 'bn' ? 'bn-BD' : 'en-US')}</td>
                    <td class="py-3">${typeText[ot.type]}</td>
                    <td class="py-3">${ot.hours || '-'}</td>
                    <td class="py-3">
                        <button onclick="deleteOT('${ot.id}')" class="text-red-400 hover:text-red-300">🗑️</button>
                    </td>
                `;
                otListTable.appendChild(row);
            });
            
            document.getElementById('summaryTotalOT').textContent = totalOT.toFixed(1);
            document.getElementById('summaryDay').textContent = dayCount;
            document.getElementById('summaryNight').textContent = nightCount;
            document.getElementById('summaryFriday').textContent = fridayCount;
        }

        // Load Bill List
        function loadBillList() {
            const selectedMonth = document.getElementById('listMonth').value;
            const billListTable = document.getElementById('billListTable');
            billListTable.innerHTML = '';
            
            const billData = JSON.parse(localStorage.getItem('bills_' + currentUser.phone) || '[]');
            
            const filteredData = billData.filter(bill => bill.date.startsWith(selectedMonth));
            
            if (filteredData.length === 0) {
                billListTable.innerHTML = `<tr><td colspan="4" class="py-4 text-center text-white text-opacity-70">${currentLanguage === 'bn' ? 'কোন তথ্য নেই' : 'No data found'}</td></tr>`;
                return;
            }
            
            filteredData.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            filteredData.forEach((bill) => {
                const typeText = bill.type === 'tiffin' ? translations[currentLanguage].tiffin : translations[currentLanguage].night;
                
                const row = document.createElement('tr');
                row.classList.add('border-b', 'border-white', 'border-opacity-10');
                row.innerHTML = `
                    <td class="py-3">${new Date(bill.date).toLocaleDateString(currentLanguage === 'bn' ? 'bn-BD' : 'en-US')}</td>
                    <td class="py-3">${typeText}</td>
                    <td class="py-3">৳${bill.amount}</td>
                    <td class="py-3">
                        <button onclick="deleteBill('${bill.id}')" class="text-red-400 hover:text-red-300">🗑️</button>
                    </td>
                `;
                billListTable.appendChild(row);
            });
        }
        
        // Delete OT
        function deleteOT(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                let otData = JSON.parse(localStorage.getItem('overtime_' + currentUser.phone) || '[]');
                otData = otData.filter(ot => ot.id !== id);
                localStorage.setItem('overtime_' + currentUser.phone, JSON.stringify(otData));
                
                database.ref('overtime/' + currentUser.phone + '/' + id).remove()
                    .catch(error => console.error('Firebase error:', error));
                
                loadOTList();
                loadUserData();
            }
        }

        // Delete Bill
        function deleteBill(id) {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                let billData = JSON.parse(localStorage.getItem('bills_' + currentUser.phone) || '[]');
                billData = billData.filter(bill => bill.id !== id);
                localStorage.setItem('bills_' + currentUser.phone, JSON.stringify(billData));
                
                database.ref('bills/' + currentUser.phone + '/' + id).remove()
                    .catch(error => console.error('Firebase error:', error));
                
                loadBillList();
                loadUserData();
            }
        }
        
        // Show Edit Profile
        function showEditProfile() {
            document.getElementById('editName').value = currentUser.name;
            document.getElementById('editPosition').value = currentUser.position;
            document.getElementById('editGrade').value = currentUser.grade;
            document.getElementById('editSalary').value = currentUser.salary;

            const lastEditDate = new Date(currentUser.lastEditDate || currentUser.createdAt);
            const today = new Date();
            const daysSinceEdit = Math.floor((today - lastEditDate) / (1000 * 60 * 60 * 24));

            if (daysSinceEdit < 15) {
                document.getElementById('editForm').style.display = 'none';
                document.getElementById('editLocked').style.display = 'block';
                const unlockDate = new Date(lastEditDate);
                unlockDate.setDate(unlockDate.getDate() + 15);
                document.getElementById('editUnlockDate').textContent = `Can edit on: ${unlockDate.toLocaleDateString()}`;
            } else {
                document.getElementById('editForm').style.display = 'block';
                document.getElementById('editLocked').style.display = 'none';
            }

            showPage('editProfile');
        }

        function saveProfile() {
            const lastEditDate = new Date(currentUser.lastEditDate || currentUser.createdAt);
            const today = new Date();
            const daysSinceEdit = Math.floor((today - lastEditDate) / (1000 * 60 * 60 * 24));

            if (daysSinceEdit < 15) {
                alert(translations[currentLanguage].editLocked);
                return;
            }

            currentUser.name = document.getElementById('editName').value;
            currentUser.position = document.getElementById('editPosition').value;
            currentUser.grade = document.getElementById('editGrade').value;
            currentUser.salary = parseFloat(document.getElementById('editSalary').value);
            currentUser.lastEditDate = new Date().toISOString();

            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            database.ref('users/' + currentUser.phone).update(currentUser)
                .catch(error => console.error('Firebase error:', error));

            alert(translations[currentLanguage].editSuccess);
            loadUserData();
            showPage('profile');
        }

        function changePIN() {
            const oldPin = document.getElementById('currentPin').value;
            const newPin = document.getElementById('newPin').value;
            const confirmPin = document.getElementById('confirmPin').value;

            if (oldPin !== currentUser.pin) {
                alert(translations[currentLanguage].oldPinWrong);
                return;
            }

            if (newPin !== confirmPin) {
                alert(translations[currentLanguage].pinsNotMatch);
                return;
            }

            if (newPin.length !== 4 || isNaN(newPin)) {
                alert(translations[currentLanguage].enter4DigitPin);
                return;
            }

            currentUser.pin = newPin;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            const users = JSON.parse(localStorage.getItem('users') || '{}');
            users[currentUser.phone].pin = newPin;
            localStorage.setItem('users', JSON.stringify(users));

            database.ref('users/' + currentUser.phone).update({ pin: newPin })
                .catch(error => console.error('Firebase error:', error));

            alert(translations[currentLanguage].pinChanged);
            
            document.getElementById('currentPin').value = '';
            document.getElementById('newPin').value = '';
            document.getElementById('confirmPin').value = '';
        }

        // Subscription Functions
        function showSubscription() {
            showPage('subscription');
            selectedPlan = null;
            document.querySelectorAll('.plan-card').forEach(card => card.classList.remove('active'));
            document.getElementById('proceedBtn').style.display = 'none';
        }

        function selectPlan(plan) {
            selectedPlan = plan;
            document.querySelectorAll('.plan-card').forEach(card => card.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.getElementById('proceedBtn').style.display = 'block';
        }

        function proceedPayment() {
            if (!selectedPlan) {
                alert('Please select a plan');
                return;
            }
            showPage('payment');
            const planNames = { basic: 'Basic', premium: 'Premium', pro: 'Pro', ultra: 'Ultra' };
            document.getElementById('paymentTitle').textContent = planNames[selectedPlan] + ' Plan - Payment';
        }

        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            document.querySelectorAll('[id$="Btn"]').forEach(btn => btn.classList.remove('bg-blue-500'));
            document.getElementById(method + 'Btn').classList.add('bg-blue-500');
            document.getElementById('paymentForm').style.display = 'block';
        }

        function showImageUploadInfo() {
            document.getElementById('imageUploadModal').classList.add('active');
        }

        function submitPayment() {
            if (!selectedPaymentMethod) {
                alert(translations[currentLanguage].selectPaymentMethod);
                return;
            }

            const accountNumber = document.getElementById('accountNumber').value;
            const transactionId = document.getElementById('transactionId').value;
            const lastFourDigits = document.getElementById('lastFourDigits').value;
            const screenshotUrl = document.getElementById('screenshotUrl').value;

            if (!accountNumber || !transactionId || !lastFourDigits || !screenshotUrl) {
                alert(translations[currentLanguage].fillPaymentDetails);
                return;
            }

            const paymentData = {
                plan: selectedPlan,
                method: selectedPaymentMethod,
                accountNumber: accountNumber,
                transactionId: transactionId,
                lastFourDigits: lastFourDigits,
                screenshotUrl: screenshotUrl,
                status: 'pending',
                createdAt: new Date().toISOString()
            };

            localStorage.setItem('subscription_' + currentUser.phone, JSON.stringify(paymentData));
            database.ref('subscriptions/' + currentUser.phone).set(paymentData)
                .catch(error => console.error('Firebase error:', error));

            alert(translations[currentLanguage].paymentSubmitted);
            
            document.getElementById('accountNumber').value = '';
            document.getElementById('transactionId').value = '';
            document.getElementById('lastFourDigits').value = '';
            document.getElementById('screenshotUrl').value = '';

            updateSubscriptionDisplay();
            document.getElementById('subscriptionPendingModal').classList.add('active');
        }

        function openUpdateLink() {
            window.open('https://github.com/garments-ot/app', '_blank');
        }
        
        // Show Page
        function showPage(page) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            
            if (event && event.currentTarget && event.currentTarget.classList.contains('nav-item')) {
                event.currentTarget.classList.add('active');
            }
            
            document.getElementById(page + 'Page').classList.add('active');
            
            if (page === 'list') {
                loadOTList();
                loadBillList();
            } else if (page === 'home') {
                loadUserData();
                loadHolidays();
            }
        }
        
        // Toggle Dark Mode
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark');
            localStorage.setItem('darkMode', isDarkMode);
            updateDarkModeToggle();
        }
        
        function updateDarkModeToggle() {
            const toggle = document.getElementById('darkModeToggle');
            const circle = toggle.querySelector('div');
            if (isDarkMode) {
                circle.style.left = 'calc(100% - 1.375rem)';
            } else {
                circle.style.left = '0.125rem';
            }
        }
        
        // Toggle Language
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'bn' : 'en';
            localStorage.setItem('language', currentLanguage);
            updateLanguage();
            loadUserData();
            loadHolidays();
            loadOTList();
            loadBillList();
        }
        
        // Show Help
        function showHelp() {
            alert('Help: Track your overtime and calculate salary easily!');
        }
        
        // Show Privacy
        function showPrivacy() {
            alert('Privacy Policy: We protect your personal information.');
        }
        
        // Show About
        function showAbout() {
            alert('About: Garments OT Calculator v1.0.0\nCreated for garments workers in Bangladesh');
        }
        
        // Close Modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // Logout
        function logout() {
            if (confirm(translations[currentLanguage].confirmLogout)) {
                localStorage.removeItem('currentUser');
                currentUser = null;
                document.getElementById('mainApp').classList.remove('active');
                document.getElementById('authPage').classList.add('active');
                showLogin();
            }
        }
        
        // Close modal on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
